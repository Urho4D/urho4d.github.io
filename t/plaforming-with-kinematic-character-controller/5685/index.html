<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width" name="viewport"/>
  <title>
   Plaforming with kinematic character controller
  </title>
  <link href="../../../archived.css" rel="stylesheet"/>
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
  </script>
  <script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
  </script>
 </head>
 <body>
  <header class="header">
   <div class="title-span">
    <a href="../../../">
     <img alt="Urho3D" height="40" id="site-logo" src="../../../images/site-logo.png"/>
    </a>
   </div>
  </header>
  <div class="main">
   <div class="archive-span">
    Archive 19/01/2023.
   </div>
   <h1 class="topic-title">
    Plaforming with kinematic character controller
   </h1>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       Repo posted -
       <a href="https://github.com/Lumak/Urho3D-KinematicCharacterController">
        https://github.com/Lumak/Urho3D-KinematicCharacterController
       </a>
      </p>
      <div class="lazyYT" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque" data-width="480" data-youtube-id="IyEY2IIJGAU" data-youtube-title="Kinematic Character Controller">
      </div>
      <p>
       This was the last item on my to-do-list related to Bullet Physics implementation for Urho3D, something I wanted to complete for a while and finally done, yay!
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/44af2cc7f66f8ae81d9d54e3c26dce121922cad21ac9383999d3d4d4db1d05fa.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Miegamicis
     </div>
     <div class="post_content">
      <p>
       Glad to see you coming back with more amazing features!
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/e2c678c8277e6ca97df6fc88b8ad3494f7d15c9f66160c9bf76cf98efd95c633.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      suppagam
     </div>
     <div class="post_content">
      <p>
       That looks awesome! Would love to see some ledge-grabbing action there.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       repo created. post if you encounter any problem.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/385b65793f17b278eb7643690d9fbdfe4fbb588d8259829590f786f4ec8e80ad.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      glitch-method
     </div>
     <div class="post_content">
      <p>
       seconded, adding ledge-grab (and maybe climb for small objects) would make this a practically usable model out-of-the-box.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9f4d89a6ec8768b8bd5426c30c4812f04cddcb7e43e803179951cb20a4f1c8bf.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Modanung
     </div>
     <div class="post_content">
      <p>
       Depending on the use case, it already is.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/616fa05f1013e3614a4d081038142fb528f27ac0018bf7a24d481c1658c1e90e.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      elix22
     </div>
     <div class="post_content">
      <p>
       Awesome demo .
       <br/>
       Do you plan to submit a P.R. ?
      </p>
      <p>
       Besides the changes in PhysicsWorld.h and PhysicsWorld.cpp
      </p>
      <p>
       I did several modifications to make it work on the latest branch .
      </p>
      <p>
       1-
       <br/>
       In
       <strong>
        playGroundTest.xml
       </strong>
       , changed the hash from “3025579211”  to “1301124395”
      </p>
      <pre><code>`&lt;node id="34"&gt;`
    &lt;attribute name="Variables"&gt;
				&lt;variant hash="1301124395" type="Bool" value="true" /&gt;
	&lt;/attribute&gt;
&lt;/node&gt;
</code></pre>
      <p>
       2 - Added at the end of the function :
      </p>
      <pre><code>void MovingPlatform::Initialize(Node *platformNode, const Vector3 &amp;finishPosition, bool updateBodyOnPlatform)
{
....
....
      platformVolumdNode_-&gt;SetVar(StringHash("IsMovingPlatform"), true);
}</code></pre>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       Did the hashing function change since 1.7?
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/616fa05f1013e3614a4d081038142fb528f27ac0018bf7a24d481c1658c1e90e.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      elix22
     </div>
     <div class="post_content">
      <p>
       Looks like it did
      </p>
      <p>
       Current  =&gt;  Case sensitive hashing
      </p>
      <pre><code>unsigned StringHash::Calculate(const char* str, unsigned hash)
{
    if (!str)
        return hash;

    while (*str)
    {
        hash = SDBMHash(hash, (unsigned char)*str++);
    }

    return hash;
}  
</code></pre>
      <p>
       1.7 =&gt; case insensitive hashing ,
       <code>
        tolower(c)
       </code>
      </p>
      <pre><code>    unsigned StringHash::Calculate(const char* str)
    {
        unsigned hash = 0;

        if (!str)
            return hash;

        while (*str)
        {
            // Perform the actual hashing as case-insensitive
            char c = *str;
            hash = SDBMHash(hash, (unsigned char)tolower(c));
            ++str;
        }

        return hash;
    }</code></pre>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       Ok, thanks for the info.
       <br/>
       I am done with my work on the kinematic char controller platforming and have moved onto another project on my to-do list. You are more than welcome to submit a PR of that work as if it was your own, or enhance it, or whatever you desire.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/f69ea984b2c306d927c43cc055958749823ce2cb9f1b9eda277be4af2b4d59cc.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Valdar
     </div>
     <div class="post_content">
      <p>
       <span class="mention">
        @Lumak
       </span>
       Really nice work, as usual
       <img alt=":+1:" class="emoji" src="../../../images/42b43325b3edacba2a0e72b742bdc6fc5e4bc2ad38adca271fcc6d8353639887.png" title=":+1:"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/d6f16bb77f117ebf72214ce8d214a620b17dea32a311cd6a88ec4b0caafaea44.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      GodMan
     </div>
     <div class="post_content">
      <p>
       <span class="mention">
        @Lumak
       </span>
       Great job. I have seen some of your other work. You are great with the physics API.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/e8230d566fa55a496fe2bb662e12b27375fbc0e4afdec2322b46e02a509bd18d.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      SuperVehicle-001
     </div>
     <div class="post_content">
      <p>
       Woooo, look at the robot go down the ramp without bouncing all over the place! That feature alone makes this incredibly useful, and it honestly should be part of the core Urho3D package…
      </p>
      <p>
       In truth, this is
       <strong>
        too
       </strong>
       useful. I’ve been working on a small personal project which is a platformer, and the difference between this kinematic controller and a “normal” character controller is like night and day. But this is all C++ code, and my project mainly uses Lua scripts…
      </p>
      <p>
       I’ve been trying to port this controller to Lua myself but I’m having terrible luck with it. I even tried including the component inside the executable and then calling it within the scripts, but that didn’t work either
       <img alt=":frowning:" class="emoji" src="../../../images/f52368fabff51bf20b9b2a7726cfecb3ca01ecdec8d99f872cca862812b131a7.png" title=":frowning:"/>
       . So I wanted to ask if anyone else has managed to successfully incorporate this kinematic controller in a Lua project?
      </p>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>