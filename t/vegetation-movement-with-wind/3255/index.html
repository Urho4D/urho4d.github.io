<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width" name="viewport"/>
  <title>
   Vegetation movement with wind
  </title>
  <link href="../../../archived.css" rel="stylesheet"/>
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
  </script>
  <script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
  </script>
 </head>
 <body>
  <header class="header">
   <div class="title-span">
    <a href="../../../">
     <img alt="Urho3D" height="40" id="site-logo" src="../../../images/site-logo.png"/>
    </a>
   </div>
  </header>
  <div class="main">
   <div class="archive-span">
    Archive 19/01/2023.
   </div>
   <h1 class="topic-title">
    Vegetation movement with wind
   </h1>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/11660fa5b850b6c45cfc0b243f5f3c9f609bf8f36e00911a3972d4acb1241151.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      darkirk
     </div>
     <div class="post_content">
      <p>
       Anyone has any idea on how do to something like this in Urho?
      </p>
      <div class="lazyYT" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque" data-width="480" data-youtube-id="_2sx6JPdlmw" data-youtube-title="How to add wind to foliage unreal engine 4">
      </div>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/6fbaa802df07aa0ddfefd532e1b448044f55faadc87345328b22519732cf0e66.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Victor
     </div>
     <div class="post_content">
      <p>
       Hey there!
      </p>
      <p>
       Both Lumak and Eugene have excellent examples here:
      </p>
      <aside class="onebox whitelistedgeneric">
       <header class="source">
        <img class="site-icon" height="32" src="../../../images/c141c7f37f4693aede059b0ec09be4e00c60670280a75f4ad744775405dcd4b4.ico" width="32"/>
        <a href="https://discourse.urho3d.io/t/10-000-grass-nodes/2394?source_topic_id=2894" rel="nofollow noopener" target="_blank">
         Urho3D
        </a>
       </header>
       <article class="onebox-body">
        <div class="aspect-image" style="--aspect-ratio:690/388;">
         <img class="thumbnail" src="../../../images/a5082b32feaa54452aa0c5741ca6a56776c05efff768cb8e74f6a5ce1dca298b.jpg"/>
        </div>
        <h3>
         <a href="https://discourse.urho3d.io/t/10-000-grass-nodes/2394?source_topic_id=2894" rel="nofollow noopener" target="_blank">
          10,000 grass nodes
         </a>
        </h3>
        <p>
         I saw a Urho3D video on youtube some months ago demonstrating replicated grass in the scene.  I don't know how many grass nodes were placed in the scene, but I clearly remember the low frame rate at around 20 - 35 fps.   I wanted to test this and...
        </p>
       </article>
       <div class="onebox-metadata">
       </div>
       <div style="clear: both">
       </div>
      </aside>
      <aside class="onebox whitelistedgeneric">
       <header class="source">
        <img class="site-icon" height="32" src="../../../images/c141c7f37f4693aede059b0ec09be4e00c60670280a75f4ad744775405dcd4b4.ico" width="32"/>
        <a href="https://discourse.urho3d.io/t/procedural-vegetation/2168" rel="nofollow noopener" target="_blank">
         Urho3D
        </a>
       </header>
       <article class="onebox-body">
        <div class="aspect-image" style="--aspect-ratio:690/375;">
         <img class="thumbnail" src="../../../images/086b0cef3c8ee086cf54250c239f29b363c1516941d2dd24437d3ca04a7974ca.jpg"/>
        </div>
        <h3>
         <a href="https://discourse.urho3d.io/t/procedural-vegetation/2168" rel="nofollow noopener" target="_blank">
          Procedural vegetation
         </a>
        </h3>
        <p>
         I have started porting procedural vegetation from my engine onto Urho3D codebase. Here are reference screenshots from my old demo.        cadaver, Do you need such functionality in Urho3D core? If yes, I'll write code...
        </p>
       </article>
       <div class="onebox-metadata">
       </div>
       <div style="clear: both">
       </div>
      </aside>
      <p>
       I hope those are helpful
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/11660fa5b850b6c45cfc0b243f5f3c9f609bf8f36e00911a3972d4acb1241151.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      darkirk
     </div>
     <div class="post_content">
      <p>
       Lumak seems to be manipulating the vertices directly:
       <a href="https://github.com/Lumak/Urho3D-Geom-Replication/blob/master/Source/Samples/62_GeomReplicator/StaticScene.cpp#L265" rel="nofollow noopener">
        https://github.com/Lumak/Urho3D-Geom-Replication/blob/master/Source/Samples/62_GeomReplicator/StaticScene.cpp#L265
       </a>
      </p>
      <p>
       Wouldn’t that be more efficient as a vertex shader?
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       You’re probably right and you’d be better off using Eugene’s procedural vegetation for your needs. My repo, as the title implies, focuses on geom replication as to avoid creating each grass per node, but can be used for trees, rocks, boxes, w/e you need.  This came about after watching someone’s youtube vid of implementing thousands of grass nodes which ran… can’t remember, maybe 15 fps.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/11660fa5b850b6c45cfc0b243f5f3c9f609bf8f36e00911a3972d4acb1241151.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      darkirk
     </div>
     <div class="post_content">
      <p>
       But why? I mean, i’m not looking for procedural generation. I’m creating my vegetation assets by hand and i just want to add the wind effect to them.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       It’ll be sweet if you can write a shader for the wind effect. I’m looking forward to it
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/11660fa5b850b6c45cfc0b243f5f3c9f609bf8f36e00911a3972d4acb1241151.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      darkirk
     </div>
     <div class="post_content">
      <p>
       Unfortunately, my shader-writing skills go as far as UE4’s material editor allows me.
       <img alt=":frowning:" class="emoji" src="../../../images/f52368fabff51bf20b9b2a7726cfecb3ca01ecdec8d99f872cca862812b131a7.png" title=":frowning:"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/a90ddfa002995c31b5c93aca4213c480a31c7272db11e21266b71156c46856c7.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Eugene
     </div>
     <div class="post_content">
      <p>
       I used procedural generation because wind shader requires additional vertex information.
       <br/>
       You may try to rewrite my shader or you may generate these vertex data in addition to your geometry.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/02974071725a337b9c8cd9586a5e16b7a69387efc5322059d65949ae7f35fb57.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Alex-Doc
     </div>
     <div class="post_content">
      <p>
       I’m also planning to add wind in my game too (in a later moment).
       <br/>
       I would use the vertex colors to map the displacement weight for the wind, as it seems to happen in here:
       <a href="https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch16.html" rel="nofollow noopener">
        https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch16.html
       </a>
      </p>
      <p>
       <span class="mention">
        @Eugene
       </span>
       can you please tell me which additional vertex data you used?
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/a90ddfa002995c31b5c93aca4213c480a31c7272db11e21266b71156c46856c7.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Eugene
     </div>
     <div class="post_content">
      <p>
       Huh, let me recall…
      </p>
      <p>
       Wind system was partially stolen from Unity.
       <br/>
       The wind consists of the following parts:
      </p>
      <ol>
       <li>
        Main wind controls tree bending caused by wind.
        <br/>
        <code>
         main_wind = main_magnitude + oscillation_magnitude * wave_function(time * oscillation_frequency)
        </code>
       </li>
       <li>
        Turbulence controls branches waving up-down.
       </li>
       <li>
        Foliage waving is somehow computed…
       </li>
      </ol>
      <p>
       Then, vertex parameters:
      </p>
      <ol>
       <li>
        Base magnitude controls the influence of main wind. Magnitude is zero at the ground.
       </li>
       <li>
        Turbulence magnitude and frequency control the influence of turbulence wind. Magnitude is zero at the trunk.
       </li>
       <li>
        Foliage oscillation magnitude and frequency control the intensity of leaves trembling. Magnitude is zero at the branch.
       </li>
       <li>
        True normal of geometry used to wave leaves. If you don’t use normal hacks for better foliage shading, you may just use normals instead.
       </li>
      </ol>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/5775ca4ae33489a2bcc299dd30363673c37d994ec83cfc8b666b914026ff2719.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      rasteron
     </div>
     <div class="post_content">
      <aside class="quote no-group" data-full="true" data-post="5" data-topic="3255" data-username="darkirk">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/b26031bad8844721d81d0652ef95b24e6d8aefab9517f489ad2b80534848d285.png" width="20"/>
        darkirk:
       </div>
       <blockquote>
        <p>
         But why? I mean, i’m not looking for procedural generation. I’m creating my vegetation assets by hand and i just want to add the wind effect to them.
        </p>
       </blockquote>
      </aside>
      <p>
       If you just need basic wind effect on your vegetation, there’s already one example available that comes with the default materials and options in shader (Vegetation.glsl/hlsl), which should be enough, unless you’re looking for something else or better.
      </p>
      <aside class="onebox githubblob" data-onebox-src="https://github.com/urho3d/Urho3D/blob/master/bin/Data/Materials/MushroomWind.xml">
       <header class="source">
        <a href="https://github.com/urho3d/Urho3D/blob/master/bin/Data/Materials/MushroomWind.xml" rel="noopener nofollow ugc" target="_blank">
         github.com
        </a>
       </header>
       <article class="onebox-body">
        <h4>
         <a href="https://github.com/urho3d/Urho3D/blob/master/bin/Data/Materials/MushroomWind.xml" rel="noopener nofollow ugc" target="_blank">
          urho3d/Urho3D/blob/master/bin/Data/Materials/MushroomWind.xml
         </a>
        </h4>
        <pre><code class="lang-xml">&lt;material&gt;
    &lt;technique name="Techniques/VegetationDiff.xml" /&gt;
    &lt;texture unit="diffuse" name="Textures/Mushroom.dds" /&gt;
    &lt;parameter name="MatSpecColor" value="0.1 0.1 0.1 16" /&gt;
    &lt;parameter name="WindPeriod" value="1" /&gt;
    &lt;parameter name="WindHeightFactor" value="0.2" /&gt;
    &lt;parameter name="WindHeightPivot" value="0.2" /&gt;
    &lt;parameter name="WindWorldSpacing" value="0.1 0.1" /&gt;
&lt;/material&gt;</code></pre>
       </article>
       <div class="onebox-metadata">
       </div>
       <div style="clear: both">
       </div>
      </aside>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/11660fa5b850b6c45cfc0b243f5f3c9f609bf8f36e00911a3972d4acb1241151.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      darkirk
     </div>
     <div class="post_content">
      <p>
       I’m using CryEngine’s technique for painting wind effect strength on vertexes:
       <a href="http://docs.cryengine.com/display/SDKDOC2/Detail+Bending" rel="nofollow noopener">
        http://docs.cryengine.com/display/SDKDOC2/Detail+Bending
       </a>
      </p>
      <p>
       I’ m going to try to modify the mushroom to read that info when applying wind. Thanks for the tip.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/3f62809ed9fdf102657417b89a906b2d7fe896a9ff4ef498d2c9cc6e7786e0f8.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      sampad1370
     </div>
     <div class="post_content">
      <p>
       Hi
       <span class="mention">
        @darkirk
       </span>
       <br/>
       Are you solve your problem?
       <br/>
       I interested to know what result!
       <br/>
       thanks you.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/11660fa5b850b6c45cfc0b243f5f3c9f609bf8f36e00911a3972d4acb1241151.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      darkirk
     </div>
     <div class="post_content">
      <p>
       Nope. I’m still learning about shaders and how to read vertex data such as colors painted in Blender. If i have some real progress, i’ll post here.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/3f62809ed9fdf102657417b89a906b2d7fe896a9ff4ef498d2c9cc6e7786e0f8.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      sampad1370
     </div>
     <div class="post_content">
      <p>
       Thank you
       <span class="mention">
        @darkirk
       </span>
       <br/>
       I hope you get fast and good progress in those topic…
       <br/>
       best regards.
      </p>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>