<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width" name="viewport"/>
  <title>
   Hover vehicle prototype
  </title>
  <link href="../../../archived.css" rel="stylesheet"/>
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
  </script>
  <script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
  </script>
 </head>
 <body>
  <header class="header">
   <div class="title-span">
    <a href="../../../">
     <img alt="Urho3D" height="40" id="site-logo" src="../../../images/site-logo.png"/>
    </a>
   </div>
  </header>
  <div class="main">
   <div class="archive-span">
    Archive 19/01/2023.
   </div>
   <h1 class="topic-title">
    Hover vehicle prototype
   </h1>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       Couldn’t decide what kind of game to make but decided it’ll revolve around some type of physics - hover vehicle prototype: no effects, just demonstrating dynamics.
      </p>
      <p>
       Had trouble figuring out how to lock the roll angle during turning. First tried detecting if it exceeded max roll value and resetting to it but that caused wobbling/jittering effect. What you see in the video uses btGeneric6DofConstraint.
      </p>
      <div class="lazyYT" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque" data-width="480" data-youtube-id="6UUOi_E_bZ4" data-youtube-title="Urho3D Hover Vehicle">
      </div>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/464d037ed6259a2a48d7eb8fcb68d7f38f7d715b0b6b7828a29b8734a9e6a059.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      coldev
     </div>
     <div class="post_content">
      <p>
       nice demo… no mans sky urho proto…
       <img alt=":grinning:" class="emoji" src="../../../images/f88b3dd8be457c7635b001536c53b98923c1c4de31b14a9aba5910f7f9e98e7c.png" title=":grinning:"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/c01b8b8b05b6aab492df6eeace88e2282147607ff86cdc28638e9227819a3fcc.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Bananaft
     </div>
     <div class="post_content">
      <p>
       You can try separating physics object and visual model. Make physics one to never roll, and make visual model to roll based on physics object turn speed.
      </p>
      <aside class="quote no-group quote-modified" data-post="2" data-topic="3182" data-username="coldev">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/45612d33c23de5e8e61dc9539255867ed635b0990ca3a335ddf4c95d5d6055c9.png" width="20"/>
        coldev:
       </div>
       <blockquote>
        <p>
         no mans sky urho proto.
        </p>
       </blockquote>
      </aside>
      <p>
       no that’s empire strikes back hoth battle.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9f4d89a6ec8768b8bd5426c30c4812f04cddcb7e43e803179951cb20a4f1c8bf.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Modanung
     </div>
     <div class="post_content">
      <p>
       Yea looks nice. I would suggest a non-linear relation between the turning speed and banking amount; put a
       <code>
        Sqrt
       </code>
       or
       <code>
        Pow
       </code>
       somewhere.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <aside class="quote no-group" data-post="2" data-topic="3182" data-username="coldev">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/45612d33c23de5e8e61dc9539255867ed635b0990ca3a335ddf4c95d5d6055c9.png" width="20"/>
        coldev:
       </div>
       <blockquote>
        <p>
         nice demo… no mans sky urho proto…
         <img alt=":grinning:" class="emoji" src="../../../images/f88b3dd8be457c7635b001536c53b98923c1c4de31b14a9aba5910f7f9e98e7c.png" title=":grinning:"/>
        </p>
       </blockquote>
      </aside>
      <p>
       Thx. Still working on hovering aspect as it still kinda oscillates up and down a bit, but it’ll get there.[quote=“Bananaft, post:3, topic:3182”]
       <br/>
       You can try separating physics object and visual model. Make physics one to never roll, and make visual model to roll based on physics object turn speed.
       <br/>
       [/quote]
       <br/>
       That might actually be a lot simpler than using btGeneric6DofConstraint method because it was tricky figuring out how to get around the multiple axis constraint issue.
      </p>
      <aside class="quote no-group" data-full="true" data-post="4" data-topic="3182" data-username="Modanung">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/aeaea6726faedfa91917f38de6ad6e3f6de3dd85253c80b15cbacaf4e003da29.png" width="20"/>
        Modanung:
       </div>
       <blockquote>
        <p>
         Yea looks nice. I would suggest a non-linear relation between the turning speed and banking amount; put a Sqrt or Pow somewhere.
        </p>
       </blockquote>
      </aside>
      <p>
       Something similar to using a quadratic curve? That might work, not sure if it still won’t result in a jitter at desired max roll angles. Will have to test at some point.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9f4d89a6ec8768b8bd5426c30c4812f04cddcb7e43e803179951cb20a4f1c8bf.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Modanung
     </div>
     <div class="post_content">
      <aside class="quote no-group" data-post="5" data-topic="3182" data-username="Lumak">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/252640214a84be6077df450d5b247e7a6d76f6c970493425153a025bbd0e3fd0.png" width="20"/>
        Lumak:
       </div>
       <blockquote>
        <p>
         Something similar to using a quadratic curve?
        </p>
       </blockquote>
      </aside>
      <p>
       Quadratic functions are limited to power-of-two situations by definition, but yea some exponential relation.
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
      </p>
      <aside class="quote no-group" data-post="5" data-topic="3182" data-username="Lumak">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/252640214a84be6077df450d5b247e7a6d76f6c970493425153a025bbd0e3fd0.png" width="20"/>
        Lumak:
       </div>
       <blockquote>
        <p>
         That might work, not sure if it still won’t result in a jitter at desired max roll angles.
        </p>
       </blockquote>
      </aside>
      <p>
       Well, the idea is that the changes in the effect get less and less towards the extremes.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       Right, it seems exponential computation might be more common than I expected. I’ll need to test it sometime.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9f4d89a6ec8768b8bd5426c30c4812f04cddcb7e43e803179951cb20a4f1c8bf.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Modanung
     </div>
     <div class="post_content">
      <p>
       <img height="320" src="../../../images/fb91377646b02b7f6f7c76f5c6d29e5a2cdb45093c875dbd39b082ca273ab23d.png" width="690"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       All right, took some time to actually integrate btGeneric6DofConstraint from test code to Urho3D::Constraint class.  Currently, its use is similar to using the
      </p>
      <pre><code class="lang-auto">    btGeneric6DofConstraint(btRigidBody&amp; rbB, const btTransform&amp; frameInB, bool useLinearReferenceFrameB);</code></pre>
      <p>
       constructor for the caller. But to get around the multiple axis constraint issue when using btGeneric6DofConstraint class, the 2nd btRigidBody is not static but dynamically created (opaque to the caller)  because its rotation is manipulated at runtime to overcome the axis constraint issue. And current implementation only deals with angular limit.
      </p>
      <p>
       Anyway, I can create a repo for the integrated Urho3D::Constraint with this addition.  Unfortunately, I cannot post the flyer code since it’s based on Unity - it’s free to use but I believe there’s restriction on posting it as open-source code.
       <br/>
       Let me know if anyone is interested in seeing a repo for this.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/03bd1f8a3e6efbea4fb5c7378bff890a9215df01e5f8713dddfe305ebe3c252c.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      hdunderscore
     </div>
     <div class="post_content">
      <p>
       Any chance to PR it ?
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       I typically just create my own repo.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       Projectile and explosion testing. I’m posting this because when others post their game progress, it inspires me.
      </p>
      <div class="lazyYT" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque" data-width="480" data-youtube-id="BL8w6UBiJ1M" data-youtube-title="Hovercraft projectile and explosion test">
      </div>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       From programmers perspective, I thought the cyan plasma and explosion looked good. Maybe I just don’t have an artist’s eye.
      </p>
      <p>
       Does this look better?
       <br/>
       <video controls="" height="360" preload="none" width="640">
        <source src="../../../images/9ce47aa0c85568ee66664a08547a9d85324aaac4971ec2e820cfdb84b3788b62.mp4" type="video/mp4"/>
        Your browser does not support the video tag.
       </video>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9f4d89a6ec8768b8bd5426c30c4812f04cddcb7e43e803179951cb20a4f1c8bf.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Modanung
     </div>
     <div class="post_content">
      <p>
       How about cyan bullets with a cyan-to-orange explosion? To suggest ignition of the backstop by the bullet.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       So… you don’t like either one?
      </p>
      <p>
       btw, if you get a chance to implement your exponential forces to lock down rotation, I’d like to see it.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/65f09c7224ca68a4d16618500cded4d288c4f6d5f84eb5eaff93394c1608f946.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      johnnycable
     </div>
     <div class="post_content">
      <p>
       seeing projectiles curving gives a fuzzy feeling imho. Gives the impression shooting is difficult. I’d give them a more straight trajectory, while retaining some curvature for effect…
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9f4d89a6ec8768b8bd5426c30c4812f04cddcb7e43e803179951cb20a4f1c8bf.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Modanung
     </div>
     <div class="post_content">
      <aside class="quote no-group" data-post="15" data-topic="3182" data-username="Lumak">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/252640214a84be6077df450d5b247e7a6d76f6c970493425153a025bbd0e3fd0.png" width="20"/>
        Lumak:
       </div>
       <blockquote>
        <p>
         So… you don’t like either one?
        </p>
       </blockquote>
      </aside>
      <p>
       I like both, but may like 'em mixed up best.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       johnnycable, projectiles actually do travel in straight path, they just appear to be curving when the vehicle and camera are moving.
      </p>
      <p>
       Modanung, ah ok. I have very little confidence in art that I make and thought that perhaps both were bad ha.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <h2>
       Stress test
      </h2>
      <h2>
       100 shooter simulation
      </h2>
      <p>
       On average:
       <br/>
       ~1600 projectiles in the scene
       <br/>
       ~200 explosions
      </p>
      <p>
       edit: added info on other images
      </p>
      <p>
       <img alt="" src="../../../images/7706c39c83a9f392278e2de9c54a82012d24e4a8a2acfc9a66349bed12db5a94.jpg"/>
      </p>
      <h2>
       50 shooter sim
      </h2>
      <p>
       ~900 projectiles in the scene
       <br/>
       ~100 explosions
      </p>
      <p>
       <img alt="" src="../../../images/bffdd73e9ca508ab07f9c07ffdf992ea31f568af9315259ae5931901684c01f5.jpg"/>
      </p>
      <h2>
       20 shooter sim
      </h2>
      <p>
       ~340 projectiles in the scene
       <br/>
       ~50 explosions
      </p>
      <p>
       <img alt="" src="../../../images/65752f0a9ab54900acda9757d7f2d192c4345aa18abd39879d8b3659e1960e80.jpg"/>
      </p>
      <p>
       <span class="mention">
        @Enhex
       </span>
       you’re the only other person that I know that’s also doing something with shooting - do these numbers look right to you?
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/668470d56163353e1e4d4d67dadbcf02db3f7389e58e6e01b1650a16815e3949.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Enhex
     </div>
     <div class="post_content">
      <p>
       Depends on things like hardware, implementation details, and what your game demands.
      </p>
      <p>
       I’d say keep it simple when first implementing stuff, and only when you have performance issues measure &amp; optimize.
      </p>
      <p>
       I don’t know any implementation details so I can’t give you actual tips for optimizing.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       Right, absolutely. What I was curious about was if you ran a similar stress test and evaluated physics process, and perhaps we could’ve compare notes.  If you haven’t, no big deal as I’m done with this part of gameplay and moving onto my next feature.
      </p>
      <p>
       edit: er, I wouldn’t call it gameplay but implementation, testing and proving that I can have several entities fire projectiles in the game.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/668470d56163353e1e4d4d67dadbcf02db3f7389e58e6e01b1650a16815e3949.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Enhex
     </div>
     <div class="post_content">
      <p>
       I did run stress tests, and my bottleneck was the AI raycasts - line of sight checks, path collision, etc.
       <br/>
       I provided
       <a href="https://urho3d.github.io/documentation/HEAD/class_urho3_d_1_1_physics_world.html#a1905d3a9482589b50ad625a5ac23c5eb" rel="nofollow noopener">
        segmented raycast
       </a>
       implementation to Urho, which in my case doubled the whole game’s FPS.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       Sorry, that didn’t come out right when I said you didn’t run a similar stress test which sounds like you ran no stress test because every developer does stress test.
      </p>
      <p>
       I didn’t know about the segmented raycast, thanks for that.
      </p>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>