<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width" name="viewport"/>
  <title>
   How to pass parameter to the 01_HellowWorld (urho3d app) from android activity (LauncherActivity.kt)
  </title>
  <link href="../../../archived.css" rel="stylesheet"/>
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
  </script>
  <script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
  </script>
 </head>
 <body>
  <header class="header">
   <div class="title-span">
    <a href="../../../">
     <img alt="Urho3D" height="40" id="site-logo" src="../../../images/site-logo.png"/>
    </a>
   </div>
  </header>
  <div class="main">
   <div class="archive-span">
    Archive 19/01/2023.
   </div>
   <h1 class="topic-title">
    How to pass parameter to the 01_HellowWorld (urho3d app) from android activity (LauncherActivity.kt)
   </h1>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/c90b5b6e18f2f2626a701b941093a3ac8f857c937610493eecf8ff7fe5bd4f1f.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      majhong
     </div>
     <div class="post_content">
      <p>
       i have a string of user’s profile in anddroid LauncherActivity
      </p>
      <p>
       i want paas it to  a urho app
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/f8c56838151bae9112a91eeb86f55cc4ef2fdee5ef2d25afc934b4d508949063.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Leith
     </div>
     <div class="post_content">
      <p>
       im sorry i cant advise yet, but i am getting there rapidly - within two weeks I guess, I will have an android build
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/44af2cc7f66f8ae81d9d54e3c26dce121922cad21ac9383999d3d4d4db1d05fa.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Miegamicis
     </div>
     <div class="post_content">
      <p>
       There is
       <span class="mention">
        @Lumak
       </span>
       repositories on Github which provide samples for that.
       <br/>
       <aside class="onebox whitelistedgeneric">
        <header class="source">
         <img class="site-icon" height="32" src="../../../images/2ee43237d196100210f1786e7b73b57cd140f6013c072c70dbdffd9e9bc695f8.ico" width="32"/>
         <a href="https://github.com/Lumak/Urho3D-Android-Project" rel="nofollow noopener" target="_blank">
          GitHub
         </a>
        </header>
        <article class="onebox-body">
         <img class="thumbnail onebox-avatar" height="400" src="../../../images/081462c49d523415f1d2066c063f5d3bc47a90fbe2139b77b5568e4fd1ffe848.jpg" width="400"/>
         <h3>
          <a href="https://github.com/Lumak/Urho3D-Android-Project" rel="nofollow noopener" target="_blank">
           Lumak/Urho3D-Android-Project
          </a>
         </h3>
         <p>
          Android project to load specific C++ executable file directly instead of Urho3DPlayer.  - Lumak/Urho3D-Android-Project
         </p>
        </article>
        <div class="onebox-metadata">
        </div>
        <div style="clear: both">
        </div>
       </aside>
       <br/>
       See the
       <code>
        ServiceCmd
       </code>
       class for more details.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/c90b5b6e18f2f2626a701b941093a3ac8f857c937610493eecf8ff7fe5bd4f1f.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      majhong
     </div>
     <div class="post_content">
      <p>
       i can invode function between activity and .so through jni.
       <br/>
       i want a  urho3d ‘offical’  solution .
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/c90b5b6e18f2f2626a701b941093a3ac8f857c937610493eecf8ff7fe5bd4f1f.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      majhong
     </div>
     <div class="post_content">
      <pre><code>/**
 * This method is called by SDL before starting the native application thread.
 * It can be overridden to provide the arguments after the application name.
 * The default implementation returns an empty array. It never returns null.
 * @return arguments for the native application.
 */
protected String[] getArguments() {
    // Urho3D: the default implementation returns the "app_process" as the first argument instead of empty array
    return new String[]{"app_process"};
}
</code></pre>
      <p>
       this is a graceful solution
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/ac13286af345bef5a8e8da90a88e9fc0e9d6f349d8aa367436e7ffdeeddaeb9e.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      weitjong
     </div>
     <div class="post_content">
      <p>
       Yes. Just remember that Urho3D engine expects the arguments in the same format as other platforms. i.e. Arg 0th in the array for the name of the program/process, arg 1st is the first argument from the app’s perspective, and so on.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/44af2cc7f66f8ae81d9d54e3c26dce121922cad21ac9383999d3d4d4db1d05fa.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Miegamicis
     </div>
     <div class="post_content">
      <p>
       Spent last few days working with the Android build system and came across the same issue. I see that the engine doesn’t support out of the box solution how the custom events could be handled between the Android app and the Urho application at runtime. Shouldn’t we think of a way how to implement this in the engine core? Basically implementing the same thing that
       <span class="mention">
        @Lumak
       </span>
       achieved and adding some sort of documentation how to use it.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/ac13286af345bef5a8e8da90a88e9fc0e9d6f349d8aa367436e7ffdeeddaeb9e.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      weitjong
     </div>
     <div class="post_content">
      <p>
       Personally I don’t see what’s wrong with the current approach of how Application and Engine classes handles the parameters.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/44af2cc7f66f8ae81d9d54e3c26dce121922cad21ac9383999d3d4d4db1d05fa.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Miegamicis
     </div>
     <div class="post_content">
      <p>
       No, I mean when the application is actually running and I need to send some sort of events back and forth for ads, login events etc. and I would like to keep the game running in the background and waiting for specific events.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/ac13286af345bef5a8e8da90a88e9fc0e9d6f349d8aa367436e7ffdeeddaeb9e.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      weitjong
     </div>
     <div class="post_content">
      <p>
       I guess it’s a different topic then. I have no comment on that.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/f8c56838151bae9112a91eeb86f55cc4ef2fdee5ef2d25afc934b4d508949063.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Leith
     </div>
     <div class="post_content">
      <p>
       You can use custom events, which are handled by your gamestate implementation(s)  via your gamestatemanager fsm…
       <br/>
       Well, that’s how I handled things in my gamestate manager. High-level requests are monitored by gamestatemanager, which operates in the background, and owns in my case, four states - intro, loading, menu and gameplay (all remain resident, but usually, only one is active). Next level down, the gamestate implementations for each major state have a chance to monitor for custom events too, and finally, in the custom urho component classes, we can do this one more time, so there are many levels at which we can take control. It’s a lot of control.
      </p>
      <p>
       I chose to make my game overlord object be derived from Urho’s object class, so that it can deal with events…
      </p>
      <pre><code class="lang-auto">    class GameStateManager : public Object
    {
        URHO3D_OBJECT(GameStateManager, Object);
    public:

        /// Factory Function
        static void RegisterObject(Context* context){
            context-&gt;RegisterFactory&lt;ClassName&gt;();
        }</code></pre>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/f8c56838151bae9112a91eeb86f55cc4ef2fdee5ef2d25afc934b4d508949063.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Leith
     </div>
     <div class="post_content">
      <p>
       The short answer is - create a background layer object that owns the game scene, and possibly other scenes too - I can show you my pattern for a game state machine for urho that handles a custom event: request for change game scene, and has a handler for handling notification of scene change completion
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/f8c56838151bae9112a91eeb86f55cc4ef2fdee5ef2d25afc934b4d508949063.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Leith
     </div>
     <div class="post_content">
      <p>
       There is a long answer too.
       <br/>
       Here is my current top level code.
       <br/>
       The application object is the top level object.
       <br/>
       Under it, lives our state manager, and under that, the game states.
      </p>
      <pre><code class="lang-auto">class MyApp : public Urho3D::Application
{

private:
    WeakPtr&lt;Scene&gt; mgrscene_;
    WeakPtr&lt;Scene&gt; gamescene_;
    WeakPtr&lt;Text&gt; text_;
    WeakPtr&lt;Node&gt; cameraNode_;
    SharedPtr&lt;GameState::GameStateManager&gt; handler;

public:
    MyApp(Context* context) :
        Application(context)
    {
    }
    virtual void Setup()
    {
        // Called before engine initialization. engineParameters_ member variable can be modified here
        engineParameters_["FullScreen"]=false;
        engineParameters_["WindowWidth"]=1280;
        engineParameters_["WindowHeight"]=720;
        engineParameters_["WindowResizable"]=true;
        //engine_-&gt;DumpResources();
    }
    virtual void Start()
    {

        // Engine has FPS capped at max. 200
        // Let's remove that cap for debug purposes
        //
        engine_-&gt;SetMaxFps(9999);

        // Register the AngelScript subsystem (a non-core subsystem)
        context_-&gt;RegisterSubsystem(new Script(context_));

        // Create 'Manager Scene' and 'Game Scene'
        mgrscene_  = new Scene(context_); mgrscene_-&gt;SetName("Manager Scene");

        // Create GameState Manager
        // This will register all relevant classes
        handler = new GameState::GameStateManager(context_);

        // Initialize GameState Manager
        // This will instantiate all gamestate classes
        handler-&gt;start(mgrscene_);



        // Register application handlers for "Core Events":
        // E_BEGINFRAME                 (Start of frame event)
        // E_UPDATE                     (Logic update event, usually used to do "normal" stuff each frame)
        // E_POSTUPDATE                 (Logic post-update event)
        // E_RENDERUPDATE               (Render update event)
        // E_POSTRENDERUPDATE           (Post-render update event)
        // E_ENDFRAME                   (End frame event)
        // See https://github.com/urho3d/Urho3D/wiki/Events for a complete list of possible events
        //
        SubscribeToEvent(E_KEYDOWN,URHO3D_HANDLER(MyApp,HandleKeyDown)); // we're just watching the ESCAPE and TAB keys here

        // Set mouse behaviour
        //GetSubsystem&lt;Input&gt;()-&gt;SetMouseMode(MM_RELATIVE);

    }</code></pre>
      <p>
       Amusingly, I don’t actually use the gamescene defined in this class - gameplaystate is a substate of the gamestate manager, so some redundant code here but you get the idea
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/44af2cc7f66f8ae81d9d54e3c26dce121922cad21ac9383999d3d4d4db1d05fa.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Miegamicis
     </div>
     <div class="post_content">
      <p>
       I was talking about events between Java and C++, I know how to send a command from C++ to Java but not the other way around. I see that Lumak updated the SDL library in the engine to support additional method which would process custom events between C++ and Java but the code at the moment is not a part of the engine and I would like to change that.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/86e08bce5ceb1ac625ac62d8b89da72813001444db7ad9b7ae9928ab38fb499f.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      orefkov
     </div>
     <div class="post_content">
      <p>
       There is old thread, but look at this PR -
       <a href="https://github.com/urho3d/Urho3D/pull/2538" rel="nofollow noopener">
        https://github.com/urho3d/Urho3D/pull/2538
       </a>
       <br/>
       Maybe it will be useful to someone.
      </p>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>