<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width" name="viewport"/>
  <title>
   Trouble importing 16bit Heightmap
  </title>
  <link href="../../../archived.css" rel="stylesheet"/>
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
  </script>
  <script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
  </script>
 </head>
 <body>
  <header class="header">
   <div class="title-span">
    <a href="../../../">
     <img alt="Urho3D" height="40" id="site-logo" src="../../../images/site-logo.png"/>
    </a>
   </div>
  </header>
  <div class="main">
   <div class="archive-span">
    Archive 19/01/2023.
   </div>
   <h1 class="topic-title">
    Trouble importing 16bit Heightmap
   </h1>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/91ead9fad7b20c8fc756db61ccc996bc77d2d65b2424352e364102fcef219df7.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      PeterZbinden
     </div>
     <div class="post_content">
      <p>
       I am new to Urho3D, so far I’m very excited about this engine.
       <br/>
       While most things seem to work fine, I ran into an issue when trying to create terrains.
      </p>
      <p>
       I am trying to import Height-Maps (created in WorldMachine) into Urho3D using the Editor:
       <br/>
       The Heightmap imports but even though the PNG is 16bit, it still seems to read it as a 8bit heightmap, as there are visible ‘stairs’ that should not be there:
       <br/>
       <div class="lightbox-wrapper">
        <a class="lightbox" data-download-href="/uploads/short-url/oDyySDj6VC2HMBDwVdf6hapsyS5.jpeg?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/a/acace6894dfb5a2ecd32004aba739c24dc693951.jpeg" rel="nofollow noopener" title="Urho_Solid.jpg">
         <img alt="Urho_Solid" data-base62-sha1="oDyySDj6VC2HMBDwVdf6hapsyS5" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/a/acace6894dfb5a2ecd32004aba739c24dc693951_2_10x10.png" height="215" src="../../../images/60f687c1a43a7d54a4c18f3af0946cfdc5fd7429d02bf3645b1e92df5a868dc5.jpeg" srcset="https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/a/acace6894dfb5a2ecd32004aba739c24dc693951_2_690x215.jpeg, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/a/acace6894dfb5a2ecd32004aba739c24dc693951_2_1035x322.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/a/acace6894dfb5a2ecd32004aba739c24dc693951_2_1380x430.jpeg 2x" width="690"/>
         <div class="meta">
          <svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon">
           <use xlink:href="#far-image">
           </use>
          </svg>
          <span class="filename">
           Urho_Solid.jpg
          </span>
          <span class="informations">
           2988×932 339 KB
          </span>
          <svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon">
           <use xlink:href="#discourse-expand">
           </use>
          </svg>
         </div>
        </a>
       </div>
       <br/>
       <a class="onebox" href="https://imgur.com/T5d9XpD" rel="nofollow noopener" target="_blank">
        <img alt="Imgur" height="315" src="../../../images/398b3a244eedcd7ec64304fba89a21cbc79bd9a7caa0f009493eb967ff4a88fb.jpg" title="Imgur" width="600"/>
       </a>
       <br/>
       <a class="onebox" href="https://imgur.com/hSTPPVT" rel="nofollow noopener" target="_blank">
        <img alt="Imgur" height="315" src="../../../images/a14b9fd14df3596ed85293724cea95e94df4ac5b335762a994bd7920ffdbb41d.png" title="Imgur" width="600"/>
       </a>
      </p>
      <p>
       When I import the same heightmap into Unity for example, the terrain is MUCH smoother:
       <br/>
       <a class="onebox" href="https://imgur.com/F438Q5k" rel="nofollow noopener" target="_blank">
        <img alt="Imgur" height="315" src="../../../images/3e3bebd69c4b7621125d256324fcba84b3ec6317b56745b34c8dd8316a0b7ecc.jpg" title="Imgur" width="600"/>
       </a>
       <br/>
       <a class="onebox" href="https://imgur.com/F9sbe3g" rel="nofollow noopener" target="_blank">
        <img alt="Imgur" height="315" src="../../../images/5564f7cf7cc4e9d094381876facbbc7de0b4c657dc280d781b8b47c07227b936.png" title="Imgur" width="600"/>
       </a>
      </p>
      <p>
       Comparing the wireframes, it doesn’t seem like the problem is because of differences in Polycount but rather how the Height-Information is read.
      </p>
      <p>
       This is how the Image is setup when i open it up in Photoshop:
       <br/>
       <a class="onebox" href="https://imgur.com/rjRVgRv" rel="nofollow noopener" target="_blank">
        <img alt="Imgur" height="315" src="../../../images/33bf21475175b6c0e208b912e97cb4aa188360b4d5c1b158bc9fad60027abcd6.png" title="Imgur" width="600"/>
       </a>
      </p>
      <p>
       What am I doing wrong? Do I have to perform manual steps before importing it in Urho?
      </p>
      <p>
       Hope you guys can help me!
      </p>
      <p>
       (Sorry for the external links, the forum doesn’t seem to allow me to upload more than 1 image per post)
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/91ead9fad7b20c8fc756db61ccc996bc77d2d65b2424352e364102fcef219df7.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      PeterZbinden
     </div>
     <div class="post_content">
      <p>
       This is the original Heightmap produced by Worldmachine, if it helps:
      </p>
      <p>
       <div class="lightbox-wrapper">
        <a class="lightbox" data-download-href="/uploads/short-url/7EGRfkMRosmpa9DwN2yGeDYSaEn.jpeg?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/3/35a8c0eb20aff90f3d63e2ff34a86395f2818b9f.jpeg" rel="nofollow noopener" title="HeightMap_x0_y1.jpg">
         <img alt="HeightMap_x0_y1" data-base62-sha1="7EGRfkMRosmpa9DwN2yGeDYSaEn" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/3/35a8c0eb20aff90f3d63e2ff34a86395f2818b9f_2_10x10.png" height="500" src="../../../images/7cb7f808dfd8861085ed313413b91c2f263da869d3de9f3e4385ca71a5874c8c.jpeg" srcset="https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/3/35a8c0eb20aff90f3d63e2ff34a86395f2818b9f_2_500x500.jpeg, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/3/35a8c0eb20aff90f3d63e2ff34a86395f2818b9f_2_750x750.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/3/35a8c0eb20aff90f3d63e2ff34a86395f2818b9f_2_1000x1000.jpeg 2x" width="500"/>
         <div class="meta">
          <svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon">
           <use xlink:href="#far-image">
           </use>
          </svg>
          <span class="filename">
           HeightMap_x0_y1.jpg
          </span>
          <span class="informations">
           1024×1024 39.3 KB
          </span>
          <svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon">
           <use xlink:href="#discourse-expand">
           </use>
          </svg>
         </div>
        </a>
       </div>
      </p>
      <p>
       The Forum-Upload seems to convert the file, so I uploaded it somewhere else:
       <br/>
       <aside class="onebox whitelistedgeneric">
        <header class="source">
         <img class="site-icon" height="32" src="../../../images/d474ed734c5e71446f7b046a35c6530fc232f974b1c3860b651b452918ab21d7.png" width="32"/>
         <a href="https://gofile.io/?c=RjL0tl" rel="nofollow noopener" target="_blank">
          gofile.io
         </a>
        </header>
        <article class="onebox-body">
         <img class="thumbnail onebox-avatar" height="300" src="../../../images/97fea62921b88269277ae6f84985f6d1c698d6b0353e20273196e8b38b1acc11.png" width="300"/>
         <h3>
          <a href="https://gofile.io/?c=RjL0tl" rel="nofollow noopener" target="_blank">
           Gofile - File sharing platform, anonymous and free
          </a>
         </h3>
         <p>
          Gofile is a free and anonymous file-sharing platform. You can store and share data of all types (files, images, music, videos etc...). There is no limit, you download at the maximum speed of your connection and everything is free.
         </p>
        </article>
        <div class="onebox-metadata">
        </div>
        <div style="clear: both">
        </div>
       </aside>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/c24c93e794e8d919ef829acfad2b3f83cbd23485bcd826225def4391e2fb0cb0.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      lezak
     </div>
     <div class="post_content">
      <p>
       I don’t think that Urho supports 16 bit grayscale height maps, from documentation:
       <br/>
       <a href="https://urho3d.github.io/documentation/HEAD/class_urho3_d_1_1_terrain.html#ad2a5a0e30901033ba358b2cf6d35d264" rel="nofollow noopener">
        bool SetHeightMap(Image* image)
        <br/>
        Set heightmap image. Dimensions should be a power of two + 1. Uses 8-bit grayscale, or optionally red as MSB and green as LSB for 16-bit accuracy. Return true if successful.
       </a>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/91ead9fad7b20c8fc756db61ccc996bc77d2d65b2424352e364102fcef219df7.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      PeterZbinden
     </div>
     <div class="post_content">
      <p>
       Hi lezak,
      </p>
      <p>
       How would I go about transforming my grayscale height map into the format specified in the documentation (red as MSB and Green as LSB)?
       <br/>
       A quick google provides me with MSB = ‘Most signifcant Bit’ and LSB = ‘Least significant Bit’ --&gt; how should I interpret this?
       <br/>
       Instead of having a Gradient from Black to white, should I convert this to a ‘Gradient’ from Green to Red?
      </p>
      <p>
       Thanks for your help!
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9f4d89a6ec8768b8bd5426c30c4812f04cddcb7e43e803179951cb20a4f1c8bf.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Modanung
     </div>
     <div class="post_content">
      <p>
       I think this post may hold the answer you are looking for:
      </p>
      <aside class="quote quote-modified" data-post="2" data-topic="2463">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" loading="lazy" src="../../../images/02fe52295e58f951d48f29e1c0d047c8dffd3f95c274632b9ab5b1e071bde0b8.png" width="20"/>
        <a href="https://discourse.urho3d.io/t/loading-16bit-pngs-for-heightmaps/2463/2">
         Loading 16bit PNGs for Heightmaps
        </a>
        <a class="badge-wrapper bullet" href="/c/showcase/code-exchange/13">
         <span class="badge-category-parent-bg" style="background-color: #F1592A;">
         </span>
         <span class="badge-category-bg" style="background-color: #231F20;">
         </span>
         <span class="badge-category clear-badge" data-drop-close="true" style="" title="Share your helpful Urho3D code snippets, samples and tutorials here.">
          Code Exchange
         </span>
        </a>
       </div>
       <blockquote>
        Hey there, first of all I’ve seen your Crown of Rulers project on the forums and I think it’s awesome
        <img alt="smiley" class="emoji" height="20" src="../../../images/771063f3b2b4950334f4d187069c87041036842149b3e4268221db325b6bde0e.png" title="smiley" width="20"/>
        Anyway, I was just trying to solve this same problem. When I found this post I got super excited, but unfortunately your code did not work for me
        <img alt="frowning" class="emoji" height="20" src="../../../images/f52368fabff51bf20b9b2a7726cfecb3ca01ecdec8d99f872cca862812b131a7.png" title="frowning" width="20"/>
        It did lead me in the right direction however! 
I was able to go from 
[terraced] 
to 
[fixed] 
with 
Image* img = new Image(context_);
std::vector&lt;unsigned char&gt; pngData;
std::vector&lt;unsigned char&gt; image;
unsigned width = 0, heigh…
       </blockquote>
      </aside>
      <p>
       Also, welcome to the forums!
       <img alt=":confetti_ball:" class="emoji" src="../../../images/f0e40083ca9e956baa5a2159c91f833a3b03b95f50f3a6a9b56b236794e7ae1e.png" title=":confetti_ball:"/>
       <img alt=":slightly_smiling_face:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slightly_smiling_face:"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/91ead9fad7b20c8fc756db61ccc996bc77d2d65b2424352e364102fcef219df7.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      PeterZbinden
     </div>
     <div class="post_content">
      <p>
       Hi Modanung,
       <br/>
       thanks for your reply, am I correct in assuming that there currently is no other way that is supported out of the box by the provided tooling of the engine to do this?
      </p>
      <p>
       Don’t get me wrong, it is perfectly feasible, just wondering why such a crucial piece of the content-pipeline is not part of the engine as most other engines seem to provide a way to integrate with industry-standard tooling (like Worldmachine), for example trough the (dead-easy) PGM-Format or the RAW-Format.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9f4d89a6ec8768b8bd5426c30c4812f04cddcb7e43e803179951cb20a4f1c8bf.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Modanung
     </div>
     <div class="post_content">
      <p>
       So far I have practically no experience or interest in using terrain.
       <span class="spoiler">
        Also, to be honest, the idea of some
        <em>
         industry-standard
        </em>
        is starting to make me nauseous. It is a notion that is destroying Blender, if you’d ask me. To me the words industry-standard mean “fancy” looks and monthly subscriptions of proprietary software aiming for a dimensionless learning curve coupled with conservative creativity.
       </span>
      </p>
      <p>
       <span class="mention">
        @JTippetts
       </span>
       is more familiar with terrain, maybe he can answer your question.
      </p>
      <p>
       <a href="https://discourse.urho3d.io/t/u3d-terrain-editor/765">
        <img alt="Screenshot" height="500" src="../../../images/c93be50017fea31f0ec574b6f71c315bea1c10582eb7063fc8cde12b59cd643b.jpg" width="666"/>
       </a>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/91ead9fad7b20c8fc756db61ccc996bc77d2d65b2424352e364102fcef219df7.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      PeterZbinden
     </div>
     <div class="post_content">
      <p>
       <span class="mention">
        @Modanung
       </span>
       ok, maybe a loaded term… Given that Game-Development today is such a complex thing to do, it seems obvious that you won’t find a product that provides ALL functionality required by itself in the best way possible without ever interacting with other Applications. Considering the ‘UNIX-Approach’ of ‘Do one thing and do it right’ it makes sense that there would be applications that do just that one thing very well. Urho does lots of things well but in the end it is a Game-Engine, not a 3D Modeler, not a Sculptor, Texturing-Application, Music Composer, Motion-Capturing environment, etc… There are tools out there that do all of this way better because they specialize in them. That doesent mean that you have to let other people (‘the industry’) dictate how your engine should work, but it would be unwise to not provide way to get at least some of this content in into the Engine trough a reliable interface that does not degrade quality etc… In fact, Urho already supports lots of these ‘Indutry-Standards’, either trough the AssetImporter (.obj, .FBX, …) or directly as a resource (.png,.dds,…) so it’s not like this concept would be new.
      </p>
      <p>
       Not trying to lecure you, just trying to point out that the reality seems to be that people are going to use whatever tools fits their needs best. Giving them the freedom to interact with whatever they choose without having to compromise on quality etc. will only empower the Users to achieve their goals and in the end make Urho3d more popular.
      </p>
      <p>
       Having a nice Terrain-System and then not providing a way to import 16bit Heightmaps imho seems like a unnecessary obstacle that if anything only hinders the engines potential.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9f4d89a6ec8768b8bd5426c30c4812f04cddcb7e43e803179951cb20a4f1c8bf.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Modanung
     </div>
     <div class="post_content">
      <p>
       The main reason I use Urho3D is because I limit myself to open source software.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/f8c56838151bae9112a91eeb86f55cc4ef2fdee5ef2d25afc934b4d508949063.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Leith
     </div>
     <div class="post_content">
      <p>
       Urho is not feature-complete, maybe it should never be. We need to work around the asset pipeline in some cases, this is typical of any game engine, including AAA ones.
       <br/>
       This does not mean we can’t or should not try to do better, but it is a fact we have to learn to accept. Even in AAA engines.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/f8c56838151bae9112a91eeb86f55cc4ef2fdee5ef2d25afc934b4d508949063.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Leith
     </div>
     <div class="post_content">
      <p>
       Does open source software include your own? Our license is liberal, I just like to share sometimes.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9f4d89a6ec8768b8bd5426c30c4812f04cddcb7e43e803179951cb20a4f1c8bf.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Modanung
     </div>
     <div class="post_content">
      <p>
       The core principle of
       <em>
        LucKey Productions
       </em>
       is to be religiously open source. That’s why I called it a cult.
       <img alt=":wink:" class="emoji" src="../../../images/f6b86554472159b74d0ab91b2cb3cd75cf361ccf96a141a4ebd3363c38e7f8eb.png" title=":wink:"/>
       <br/>
       Code is under GPL, assets CC-BY-SA.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/c24c93e794e8d919ef829acfad2b3f83cbd23485bcd826225def4391e2fb0cb0.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      lezak
     </div>
     <div class="post_content">
      <p>
       First of all I would like to notice that, there is to many threads going off-topic recently…
      </p>
      <p>
       <span class="mention">
        @PeterZbinden
       </span>
       <br/>
       I’ve taken closer look at Your problem and it looks that the actual problem lies in Your height map. The link You provided doesn’t work, so I’ve used some other 16-bit png file (cloud texture generated in substance designer) and it worked just fine.
      </p>
      <aside class="quote no-group" data-post="1" data-topic="5297" data-username="PeterZbinden">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/796753f3a195712da768e0f0f415558ed4929bca86b9c45db1dded7f6d5e941d.png" width="20"/>
        PeterZbinden:
       </div>
       <blockquote>
        <p>
         When I import the same heightmap into Unity for example, the terrain is MUCH smoother:
        </p>
       </blockquote>
      </aside>
      <p>
       Correct me if I’m wrong, but doesn’t Unity use raw files for height maps? So You’re using different file.
       <br/>
       I’ve never used World Machine, but my guess would be that quality is lost on png file generation/export.
      </p>
      <aside class="quote no-group" data-post="8" data-topic="5297" data-username="PeterZbinden">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/796753f3a195712da768e0f0f415558ed4929bca86b9c45db1dded7f6d5e941d.png" width="20"/>
        PeterZbinden:
       </div>
       <blockquote>
        <p>
         Having a nice Terrain-System and then not providing a way to import 16bit Heightmaps imho seems like a unnecessary obstacle that if anything only hinders the engines potential.
        </p>
       </blockquote>
      </aside>
      <p>
       Actually when it comes to terrain or even wider: outside enviroment, Urho is very limited. I don’t mean to sound rude, but Urho is an open source engine and if You want some feature that is not there (like World Machine support) feel free to implement it.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/91ead9fad7b20c8fc756db61ccc996bc77d2d65b2424352e364102fcef219df7.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      PeterZbinden
     </div>
     <div class="post_content">
      <p>
       <span class="mention">
        @lezak
       </span>
       while Worldmachine supports RAW-Files natively, I actualy Exported 16bit PNG (The file I tried importing into URHO3D) and then manualy converted that data into a RAW-File using Photoshop before Importing it into Unity, so no I’m prety confident that the data is actualy not the problem.
      </p>
      <p>
       Would you care to share your file and maybe a screenshot of how it looks in Urho on your machine so I could compare the results and see if there is actualy something wrong with the way a deal with these files?
      </p>
      <p>
       On the topic of implementing this myself:
       <br/>
       I’m not demanding/suggesting that someone would have to do this for me, it just seems strange to me that someone would go trough all of the trouble of creating a Terrain-System without having a way to import high quality Heightmaps.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9ffa785b379770c490f83b61c2bf1a6fd3ee52ed493a1d689aef4f1ee2ebcdc3.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      JTippetts
     </div>
     <div class="post_content">
      <p>
       Urho3D terrain has a property, Smoothing, that is for some reason set to false by default. If you enable it with
       <a href="https://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Graphics/Terrain.h#L64" rel="nofollow noopener">
        Terrain::SetSmoothing(true)
       </a>
       then the result from an 8-bit PNG will be MUCH better. 16 bit (whether traditional 16-bit or the 16-bit split between R/G as Urho3D uses) really only comes in handy at much higher terrain resolutions than your original post exhibits, when the mesh is sufficient to show the smaller details. Still, I prefer 16-bit even with small terrains, as it simplifies the tooling. I don’t use WorldMachine, and in fact I use my own custom (and unfinished
       <img alt=":smiley:" class="emoji" src="../../../images/771063f3b2b4950334f4d187069c87041036842149b3e4268221db325b6bde0e.png" title=":smiley:"/>
       ) terrain editor, but I do agree it would be nice if a traditional 16-bit PNG path was supported. Unfortunately, it is unlikely to be done until someone with a vested interest in it being done takes the initiative and does a pull request for it.
      </p>
      <p>
       In regards to your question about how the R/G channels are used, the red channel ends up being essentially identical to a standard 8-bit PNG heightmap, while the green channel holds additional detail. Say you have a terrain that ranges from 0 to 255 units high. The whole part of a height value would be encoded in the R channel, while the fractional part is encoded in the green. Red will range in a gradient from the lows to the highs, while green ranges in a gradient in between the individual units of the red channel. A typical heightmap ends up looking something like this:
      </p>
      <p>
       <a class="onebox" href="https://i.imgur.com/sypKjsL.png" rel="nofollow noopener" target="_blank">
        <img height="500" src="../../../images/48f490253be637e3864094c2c059da32582bce52e3553d90609f71c8c83f5ca9.png" width="500"/>
       </a>
      </p>
      <p>
       On the left is the composite R/G heightmap. Upper right is the red channel alone, and what it would be with just an 8-bit heightmap, on the lower right is the green channel. You can see that the large-scale features of the terrain are exhibited in the red channel, while the green holds only very small details.
      </p>
      <p>
       If you don’t want to modify the image at run-time, it should be easy enough to write a converter offline tool to batch-process heightmaps from what WorldMachine outputs to what Urho3D R/G mode expects. It’s not optimal, I know, but for now that’s all I can really suggest.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/c24c93e794e8d919ef829acfad2b3f83cbd23485bcd826225def4391e2fb0cb0.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      lezak
     </div>
     <div class="post_content">
      <p>
       Unfortunetly I doubt that smoothing will help with this stepping/banding problem - it’s caused by 16 to 8 bit convertion (like I said file that I used was not a proper height map so the result may be misleading, sorry for that).
       <br/>
       Now the obvious - does World Machine support 8bit png export? This should fix Your problem.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/91ead9fad7b20c8fc756db61ccc996bc77d2d65b2424352e364102fcef219df7.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      PeterZbinden
     </div>
     <div class="post_content">
      <p>
       <span class="mention">
        @JTippetts
       </span>
       Thanks for the extensive explanation, I’ll have a look into what my options are.
       <br/>
       Concerning using 8bit for my project:
       <br/>
       The hightmap I provided is only part of a bigger terrain, still the effect is most visible when there are subtle changes in the height. As far as I understand it, a Chanel on a 8 Bit Pixel can only have a value of between 0 and 255. If the terrain I’m trying to create has a total height of say 1000m, then any vertice can only be placed every 3.92m. In this case if I have two vertices that in the source-data differ less than these 3.92m, they will have the same height in the 8Bit Heightmap.
      </p>
      <p>
       Compared to this a chanel on a 16bit pixel can have values between 0 and 65’535 --&gt; enabling vertices to be placed every 0.015m in the same 1000m hight terrain.
       <br/>
       To get the same precision out of a 8bit Heightmap, I would have to limit my Terrain to be ~4m of height max.
      </p>
      <p>
       I guess you could live with scaling it a bit more, especialy if the source was something generated from noise-filter, as it does not realy have any meaningful identifiable shape to begin with. But when you deal with Erosion-based simulation to create beautiful environments, these issues will automaticaly become more prominent.
      </p>
      <p>
       To compare, this is what the environment looks like in Worldmachine:
       <br/>
       <div class="lightbox-wrapper">
        <a class="lightbox" data-download-href="/uploads/short-url/fIgIirXB1VbIHJqD3hFd76eVyUn.jpeg?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/6/6e21b21a1e81352607724c3ef1f19555d7a793c7.jpeg" rel="nofollow noopener" title="Worldmachine.jpg">
         <img alt="Worldmachine" data-base62-sha1="fIgIirXB1VbIHJqD3hFd76eVyUn" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/6/6e21b21a1e81352607724c3ef1f19555d7a793c7_2_10x10.png" height="355" src="../../../images/6369a4b9d611e021710d8ba2c915f6c8d07ebb541874e125b22ffc5601a01095.jpeg" srcset="https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/6/6e21b21a1e81352607724c3ef1f19555d7a793c7_2_690x355.jpeg, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/6/6e21b21a1e81352607724c3ef1f19555d7a793c7_2_1035x532.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/6/6e21b21a1e81352607724c3ef1f19555d7a793c7_2_1380x710.jpeg 2x" width="690"/>
         <div class="meta">
          <svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon">
           <use xlink:href="#far-image">
           </use>
          </svg>
          <span class="filename">
           Worldmachine.jpg
          </span>
          <span class="informations">
           2482×1279 955 KB
          </span>
          <svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon">
           <use xlink:href="#discourse-expand">
           </use>
          </svg>
         </div>
        </a>
       </div>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9f4d89a6ec8768b8bd5426c30c4812f04cddcb7e43e803179951cb20a4f1c8bf.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Modanung
     </div>
     <div class="post_content">
      <p>
       A single 16-bit channel can pack the same amount of information as two 8-bit channels, hence the red and green. Nice mountain range, btw.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9ffa785b379770c490f83b61c2bf1a6fd3ee52ed493a1d689aef4f1ee2ebcdc3.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      JTippetts
     </div>
     <div class="post_content">
      <p>
       Any 8-bit grayscale image will cause stair-stepping, which is why the smoothing option is there in Urho3D::Terrain.
      </p>
      <p>
       That image from world machine looks like it uses a terrain-sized normal map, which is a possible technique you can use to make your terrains look like they are of a much higher resolution, while still reducing the actual resolution of the mesh to improve rendering performance. Here is a quick Blender shot demonstrating that idea:
      </p>
      <p>
       <a class="onebox" href="https://i.imgur.com/U90OYIA.png" rel="nofollow noopener" target="_blank">
        <img height="426" src="../../../images/f98b964ed958cb3aaee60c5cba23c96e794f2850086ca4b2ab76c15b97c3c19b.png" width="690"/>
       </a>
      </p>
      <p>
       On the left is the original 8-bit greyscale heightmap terrain. On the right is the same terrain with a normal map applied to make it look more detailed. Same number of triangles in each render, but the one with the normal map looks better.
      </p>
      <p>
       This is a typical type of workflow for game terrains. WorldMachine can export that whole-terrain normal map for use in your shader. Note that this workflow would require a small edit to the default Urho3D terrain shader to use. Even with support for 16-bit grayscale heightmaps, this normal-mapping technique would still likely be a part of your workflow, because the 16-bit option can improve the precision of vertical placement of your heightmap vertices, but it won’t necessarily make the overall terrain look more detailed without simply increasing the subdivision level of your terrain and thus impacting performance.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/91ead9fad7b20c8fc756db61ccc996bc77d2d65b2424352e364102fcef219df7.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      PeterZbinden
     </div>
     <div class="post_content">
      <p>
       <span class="mention">
        @Modanung
       </span>
       I’m not saying that you can’t press the data in there by splitting it up, I was talking about why using a classical 8bit Heightmap (1 channel) would be problematic in most cases.
      </p>
      <p>
       <span class="mention">
        @JTippetts
       </span>
       I agree, you can push 8bit Heightmaps ‘a bit’ further with the smoothing-option, still there are limits to what it can do.
       <br/>
       8bit grayscale, no smoothing:
       <br/>
       <div class="lightbox-wrapper">
        <a class="lightbox" data-download-href="/uploads/short-url/e1QDJsCckVlInMOSJ8h6vXU0Ole.jpeg?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/6/6253f19ca8516b4f9e4bf1acc5328fe6d4b585cc.jpeg" rel="nofollow noopener" title="NoSmoothing.jpg">
         <img alt="NoSmoothing" data-base62-sha1="e1QDJsCckVlInMOSJ8h6vXU0Ole" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/6/6253f19ca8516b4f9e4bf1acc5328fe6d4b585cc_2_10x10.png" height="330" src="../../../images/0eb64cb5b080f59123f760b066fedc914e29ada3c7fc02b11009b3aa214b1769.jpeg" srcset="https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/6/6253f19ca8516b4f9e4bf1acc5328fe6d4b585cc_2_690x330.jpeg, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/6/6253f19ca8516b4f9e4bf1acc5328fe6d4b585cc_2_1035x495.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/6/6253f19ca8516b4f9e4bf1acc5328fe6d4b585cc_2_1380x660.jpeg 2x" width="690"/>
         <div class="meta">
          <svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon">
           <use xlink:href="#far-image">
           </use>
          </svg>
          <span class="filename">
           NoSmoothing.jpg
          </span>
          <span class="informations">
           2165×1037 314 KB
          </span>
          <svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon">
           <use xlink:href="#discourse-expand">
           </use>
          </svg>
         </div>
        </a>
       </div>
       <br/>
       8bit grayscale with smoothing:
       <br/>
       <div class="lightbox-wrapper">
        <a class="lightbox" data-download-href="/uploads/short-url/rxxP42sT3vpcirXlq6pBRRDFUV8.jpeg?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/c/c10572a253141a7b448c71474024ff45c6672ffe.jpeg" rel="nofollow noopener" title="WithSmoothing.jpg">
         <img alt="WithSmoothing" data-base62-sha1="rxxP42sT3vpcirXlq6pBRRDFUV8" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/c/c10572a253141a7b448c71474024ff45c6672ffe_2_10x10.png" height="297" src="../../../images/6460a172bfd0310f8439f6501b93baec617e3af090725f39c8031287bea464f6.jpeg" srcset="https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/c/c10572a253141a7b448c71474024ff45c6672ffe_2_690x297.jpeg, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/c/c10572a253141a7b448c71474024ff45c6672ffe_2_1035x445.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/c/c10572a253141a7b448c71474024ff45c6672ffe_2_1380x594.jpeg 2x" width="690"/>
         <div class="meta">
          <svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon">
           <use xlink:href="#far-image">
           </use>
          </svg>
          <span class="filename">
           WithSmoothing.jpg
          </span>
          <span class="informations">
           2499×1077 303 KB
          </span>
          <svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon">
           <use xlink:href="#discourse-expand">
           </use>
          </svg>
         </div>
        </a>
       </div>
      </p>
      <p>
       Im considering using a Normalmap for more detail once I’m able to properly import the 16bit heightmap, currently all the detail resides in the Heightmap.
      </p>
      <p>
       At the moment my focus is to establish a minimum Pipeline of how I can reliably bring high quality Terrains into Urho, making it look as pretty as possible is a topic for another time…
      </p>
      <p>
       I’ll report back as soon as I have implemented a converter from 16bit gs --&gt; 8bit r/g.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/91ead9fad7b20c8fc756db61ccc996bc77d2d65b2424352e364102fcef219df7.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      PeterZbinden
     </div>
     <div class="post_content">
      <p>
       Sorry for double-posting but I just got the 16bit-converter to work, here is the comparison to the above image with the 16bit heightmap (no smoothing):
       <br/>
       <div class="lightbox-wrapper">
        <a class="lightbox" data-download-href="/uploads/short-url/eg2TvPGwBTdUg0kRH0PK19F61t5.jpeg?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/6/63eeccb334d7cfbc7f746d46f63d98d0fe55258f.jpeg" rel="nofollow noopener" title="16bit_Terrain_NoSmoothing.jpg">
         <img alt="16bit_Terrain_NoSmoothing" data-base62-sha1="eg2TvPGwBTdUg0kRH0PK19F61t5" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/6/63eeccb334d7cfbc7f746d46f63d98d0fe55258f_2_10x10.png" height="303" src="../../../images/3a0e6b30b8a4e74ba18a269e2e0772496a833825e95ccaadc4667da48096fcdc.jpeg" srcset="https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/6/63eeccb334d7cfbc7f746d46f63d98d0fe55258f_2_690x303.jpeg, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/6/63eeccb334d7cfbc7f746d46f63d98d0fe55258f_2_1035x454.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/6/63eeccb334d7cfbc7f746d46f63d98d0fe55258f_2_1380x606.jpeg 2x" width="690"/>
         <div class="meta">
          <svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon">
           <use xlink:href="#far-image">
           </use>
          </svg>
          <span class="filename">
           16bit_Terrain_NoSmoothing.jpg
          </span>
          <span class="informations">
           2188×963 195 KB
          </span>
          <svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon">
           <use xlink:href="#discourse-expand">
           </use>
          </svg>
         </div>
        </a>
       </div>
       <br/>
       IMO quite the difference
       <img alt=":blush:" class="emoji" src="../../../images/5dc76062acc5a80d95fdd823db908640d52dac05ad1a4899ab9e723bfa0bbbfb.png" title=":blush:"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/e2c678c8277e6ca97df6fc88b8ad3494f7d15c9f66160c9bf76cf98efd95c633.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      suppagam
     </div>
     <div class="post_content">
      <p>
       How do you guys apply a normal map to an entire terrain in Urho? Something along the lines of what is possible with the old UDK:
      </p>
      <p>
       <a class="onebox" href="https://i.ytimg.com/vi/EtR-4vA6wAg/maxresdefault.jpg" rel="nofollow noopener" target="_blank">
        <img height="388" src="../../../images/31298ff57f6975d9481deb9fc63445a7d60bff91b34f2d33cfd39266a26e44d5.jpg" width="690"/>
       </a>
       <br/>
       <a class="onebox" href="https://i.imgur.com/uUfYe.jpg" rel="nofollow noopener" target="_blank">
        <img height="364" src="../../../images/8dce501ed67c6241cd9e6660235164e5bbc6aadf2710487427d702b9bffe728a.jpg" width="690"/>
       </a>
       <br/>
       <aside class="onebox whitelistedgeneric">
        <header class="source">
         <img class="site-icon" height="16" src="../../../images/a1495da3cf3db37bf105a12658636ff628fee7b73975b9200049af7747e60b1f.ico" width="16"/>
         <a href="http://ryanwwatkins.blogspot.com/2012/06/udk-desert-landscape.html" rel="nofollow noopener" target="_blank">
          ryanwwatkins.blogspot.com
         </a>
        </header>
        <article class="onebox-body">
         <div class="aspect-image" style="--aspect-ratio:130/68;">
          <img class="thumbnail" src="../../../images/0590eb0cac4e1a82f3d10d9aa36a41480f9210a7e7bbcc0c686c1d80a7aef311.jpg"/>
         </div>
         <h3>
          <a href="http://ryanwwatkins.blogspot.com/2012/06/udk-desert-landscape.html" rel="nofollow noopener" target="_blank">
           UDK Desert Landscape
          </a>
         </h3>
         <p>
          These are some work in progress images of a real time desert landscape that I'm doing as a personal project. Using the UDK I wanted to explo...
         </p>
        </article>
        <div class="onebox-metadata">
        </div>
        <div style="clear: both">
        </div>
       </aside>
      </p>
      <p>
       Technical reference:
       <br/>
       <a class="onebox" href="https://api.unrealengine.com/udk/Three/TerrainAdvancedTextures.html" rel="nofollow noopener" target="_blank">
        https://api.unrealengine.com/udk/Three/TerrainAdvancedTextures.html
       </a>
      </p>
      <p>
       Or even Torque3D terrains:
       <br/>
       <a class="onebox" href="https://theterrainguy.files.wordpress.com/2012/11/wip_00.jpg" rel="nofollow noopener" target="_blank">
        <img height="388" src="../../../images/e496670c74c6562b9878cf654b6a33e7637aadcad63b9bd2e2dd0bfdc5f762de.jpg" width="690"/>
       </a>
       <br/>
       <a class="onebox" href="https://i.imgur.com/xGZAIkY.jpg" rel="nofollow noopener" target="_blank">
        <img height="444" src="../../../images/9b5936f4006146e4e1e9025b474c02863c0b5614132ad40db4b925a10e8bfbb9.jpg" width="690"/>
       </a>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9ffa785b379770c490f83b61c2bf1a6fd3ee52ed493a1d689aef4f1ee2ebcdc3.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      JTippetts
     </div>
     <div class="post_content">
      <p>
       Out of the box, the Urho3D TerrainBlend shader can’t do a whole-terrain normal map. However, modifying it to use one is quite simple.
      </p>
      <ol>
       <li>
        Add another sampler, sNormalMap4
       </li>
       <li>
        In PS(), use the existing vTexCoord/iTexCoord (GLSL/HLSL) that is used to sample WeightMap, and use it to also sample the normal map.
       </li>
       <li>
        If the normal map is a tangent-space normal map (ie, blue) then you have to swizzle the green blue channels, so that green maps to Z and blue to Y. If it’s an object-space normal map (ie, yellow) then this is not necessary. vec3 normalsample=texture2D(sNormalMap4, vTexCoord).rbg;
       </li>
       <li>
        Convert the normal map sample to a normal by normalize(normalsample*2.0-1.0) and assign it to normal.
       </li>
      </ol>
      <p>
       You can look at
       <a href="https://pastebin.com/9h7pquMm" rel="nofollow noopener">
        https://pastebin.com/9h7pquMm
       </a>
       to see this modification done to the GLSL shader; the HLSL modification will be quite similar. And the result can be nice:
      </p>
      <p>
       <a class="onebox" href="https://i.imgur.com/QSC3Ftg.png" rel="nofollow noopener" target="_blank">
        <img height="268" src="../../../images/50ab27853869f7919de439b7b1d052f2bbdbaceca5540f71bc4e13f641ba4b1d.png" width="690"/>
       </a>
      </p>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>