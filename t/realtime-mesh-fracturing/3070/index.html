<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width" name="viewport"/>
  <title>
   Realtime mesh fracturing
  </title>
  <link href="../../../archived.css" rel="stylesheet"/>
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
  </script>
  <script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
  </script>
 </head>
 <body>
  <header class="header">
   <div class="title-span">
    <a href="../../../">
     <img alt="Urho3D" height="40" id="site-logo" src="../../../images/site-logo.png"/>
    </a>
   </div>
  </header>
  <div class="main">
   <div class="archive-span">
    Archive 19/01/2023.
   </div>
   <h1 class="topic-title">
    Realtime mesh fracturing
   </h1>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/11660fa5b850b6c45cfc0b243f5f3c9f609bf8f36e00911a3972d4acb1241151.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      darkirk
     </div>
     <div class="post_content">
      <p>
       Has anyone used voronoi to do realtime mesh deformation and fracturing in Urho3D? How would you guys do it?
      </p>
      <p>
       <a class="onebox" href="https://www.assetstore.unity3d.com/en/#!/content/9411" rel="nofollow noopener" target="_blank">
        https://www.assetstore.unity3d.com/en/#!/content/9411
       </a>
      </p>
      <p>
       Right now, i’m doing everything by hand: i create a normal mesh, then a fractured one in Blender, and then when the damage is higher than X, i swap the meshes and play a baked animation.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/28ebc440ecd4098f2a6ad505cdc9ec368de1a0cd2616ecbd951089089330fbd9.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      slapin
     </div>
     <div class="post_content">
      <p>
       I think the way you do it is the most practical one.
       <br/>
       How do you bake animation for fracturing for Urho?
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/11660fa5b850b6c45cfc0b243f5f3c9f609bf8f36e00911a3972d4acb1241151.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      darkirk
     </div>
     <div class="post_content">
      <p>
       It is practical, but it sucks for the player: everything he blows up a box or something, the same pieces go to the same places. Also, the pieces are not affected by physics, so they go through walls and everything. I have to carefully place everything.
      </p>
      <p>
       <div class="lazyYT" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque" data-width="480" data-youtube-id="38eEZyNfd3A" data-youtube-title="(Tutorial): Make Exploding Objects in Blender Easily (Cell Fracturing)">
       </div>
       <br/>
       <div class="lazyYT" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque" data-width="480" data-youtube-id="uXEk0dp79ik" data-youtube-title="Fracture Voronoi SCRIPT in 3Ds max">
       </div>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/3ea7a1555aff4c5b3dd0274b8e7ae351c7e22708a771f0a92691672b7da6e609.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      S.L.C
     </div>
     <div class="post_content">
      <p>
       Bullet physics seems to
       <a href="https://github.com/bulletphysics/bullet3/tree/master/examples/VoronoiFracture" rel="nofollow noopener">
        have something similar
       </a>
       but you’ll have to port it to Urho3D in order to use it. Probably not much but it’s a start.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/11660fa5b850b6c45cfc0b243f5f3c9f609bf8f36e00911a3972d4acb1241151.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      darkirk
     </div>
     <div class="post_content">
      <p>
       Isn’t Urho already integrated with Bullet?
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/98e16f5aa18a8278da16931cc513caf6df5e18cef318b34790a9618613ef083e.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      TheComet
     </div>
     <div class="post_content">
      <p>
       Yes but Urho only wraps the collision and rigidbody systems.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/11660fa5b850b6c45cfc0b243f5f3c9f609bf8f36e00911a3972d4acb1241151.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      darkirk
     </div>
     <div class="post_content">
      <p>
       Is there a tutorial on how to integrate other parts?
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/98e16f5aa18a8278da16931cc513caf6df5e18cef318b34790a9618613ef083e.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      TheComet
     </div>
     <div class="post_content">
      <p>
       I’m not aware of any tutorials on that, but my best advice is to just read the source code and try. The community helps you a lot if you have specific questions.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/28ebc440ecd4098f2a6ad505cdc9ec368de1a0cd2616ecbd951089089330fbd9.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      slapin
     </div>
     <div class="post_content">
      <p>
       Well, some people implement fracturing using particles. Also you can add variation using separate animations, and use some raycasts to prevent wall passing (but this might use some CPU).
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/e9ab66cb82c8ed1bfb8c9a324b4e6196d08edaf4a76c7cb82a340f9922bf2f91.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      haolly
     </div>
     <div class="post_content">
      <p>
       I have used the Exploder Unity plugin, seems it use
       <a href="https://github.com/jhasse/poly2tri" rel="nofollow noopener">
        https://github.com/jhasse/poly2tri
       </a>
       library to cut polygons.
       <br/>
       So, If U can obtain the mesh data, and do something on it, which is beyond my knowledge
       <img alt=":no_mouth:" class="emoji" src="../../../images/e14f0ccf56e8c7c123e4da42b3578b18a4d03231de63c592a9a83d038465818e.png" title=":no_mouth:"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/668470d56163353e1e4d4d67dadbcf02db3f7389e58e6e01b1650a16815e3949.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Enhex
     </div>
     <div class="post_content">
      <p>
       Games like Half-Life 2 just spawn few pre-defined “piece” models, usually with some explosion to hide the switching from the intact model to its pieces.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/65f09c7224ca68a4d16618500cded4d288c4f6d5f84eb5eaff93394c1608f946.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      johnnycable
     </div>
     <div class="post_content">
      <p>
       Why don’t you simply creates five other more “destroyable” animations and mix between them? Consider that, unless yours a game for happy destructors, most player probably won’t even notice…
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/d126304f5103b2d7cee2c6e244e6a162b45a28fcb40bfc5dd544e0bbf8b220ea.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Sinoid
     </div>
     <div class="post_content">
      <p>
       The license on the Carve library was changed to MIT by the original author,
       <a href="https://github.com/folded/carve" rel="nofollow noopener">
        his github repo for CarveCSG
       </a>
       is easy to miss since the top google result is an old fork by someone else. It’s pretty weird to work with, so getting the results you want can be a bit of trial and error.
      </p>
      <p>
       There’s
       <a href="https://github.com/alembic/alembic" rel="nofollow noopener">
        Alembic
       </a>
       for baking simulation results - it’s practically made for the cooked demolition scenario, though it’s almost as nasty to compile as
       <a href="http://www.openvdb.org/" rel="nofollow noopener">
        OpenVDB
       </a>
       (which can do fracture as well if voxelizing is okay) is.
      </p>
      <p>
       The talk on
       <a href="https://www.youtube.com/watch?v=SjkQxowsL0I" rel="nofollow noopener">
        Rainbox Six: siege’s destruction
       </a>
       is also on youtube - it’s pretty simple.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/38ba090e68e80d996997d1577a6db4973e3333bddb338b81b65f9e835ac64a44.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      rku
     </div>
     <div class="post_content">
      <p>
       <span class="mention">
        @Sinoid
       </span>
       any idea whats the performance of Carve lib? Is it useable realtime?
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/d126304f5103b2d7cee2c6e244e6a162b45a28fcb40bfc5dd544e0bbf8b220ea.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Sinoid
     </div>
     <div class="post_content">
      <p>
       <span class="mention">
        @rku
       </span>
       anywhere between 200ms - 500ms for Carve, on a potato Surface Pro 1st gen. Fast enough to appear real-time when threaded (which is the case where I got all of these measurements).
      </p>
      <ul>
       <li>
        4500 triangles
        <strong>
         minus
        </strong>
        12 triangle cube
        <ul>
         <li>
          That’s actually 3 ops (A-B, B-A, A u -B)
         </li>
        </ul>
       </li>
       <li>
        Ran in C++/CLI in actual CLI code for most of the intermediary … so not exactly a rocket
       </li>
       <li>
        Measured via System::Diagnostics::Stopwatch
        <ul>
         <li>
          Not the most accurate thing
         </li>
        </ul>
       </li>
       <li>
        Includes the time to build the vertex data and then translate the results back into something renderable
        <ul>
         <li>
          Carve uses a table based storage for attributes of vertices/edges/faces, so that’s quite a bit of workload
         </li>
         <li>
          Preparing the mesh takes: ~145ms
          <ul>
           <li>
            Canonicalize
           </li>
           <li>
            Fill buffers
           </li>
           <li>
            Difficult for me to actually measure as I do cache the half-edge mesh used for canonicals
           </li>
          </ul>
         </li>
         <li>
          Extracting the mesh takes: ~16ms
         </li>
        </ul>
       </li>
      </ul>
      <p>
       So, as a threaded work item yes. Keeping all of the intermediate Carve specific data should be enough to make the difference between usable and not usable.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/38ba090e68e80d996997d1577a6db4973e3333bddb338b81b65f9e835ac64a44.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      rku
     </div>
     <div class="post_content">
      <p>
       Thank you very much for taking time to do the test! While not the rocket it isnt too slow either. With some trickery like mentioned in R6:S talk you posted it can be totally realtime.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/d126304f5103b2d7cee2c6e244e6a162b45a28fcb40bfc5dd544e0bbf8b220ea.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Sinoid
     </div>
     <div class="post_content">
      <p>
       No problem, I kept all the Carve code around even though I ended up rolling my own CSG.
      </p>
      <hr/>
      <p>
       It certainly makes sense as part of a solution. I wouldn’t use it for something simple like subway-columns or a heightfield/planar slice.
      </p>
      <p>
       The planar blocks from the R6:S edge talk have the huge advantage that it’s trivial to generate a decal skirt for those, with vanilla CSG that’s an additional intersection and the output is triangle-soup so it means looking at edge connectivity to figure out UVs - which doesn’t sound like fun.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/98e16f5aa18a8278da16931cc513caf6df5e18cef318b34790a9618613ef083e.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      TheComet
     </div>
     <div class="post_content">
      <aside class="quote no-group" data-post="17" data-topic="3070" data-username="Sinoid">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/984688db7ff4c5c20b844d2ec005f1730c075c6c17ef9794cf9338e8bfc3aeff.png" width="20"/>
        Sinoid:
       </div>
       <blockquote>
        <p>
         looking at edge connectivity to figure out UVs
        </p>
       </blockquote>
      </aside>
      <p>
       UV data is stored per vertex, it has nothing to do with edges.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/38ba090e68e80d996997d1577a6db4973e3333bddb338b81b65f9e835ac64a44.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      rku
     </div>
     <div class="post_content">
      <p>
       Godot recently added their own realtime CSG component. Code looks fairly easily portable.
       <a href="https://github.com/godotengine/godot/tree/master/modules/csg" rel="nofollow noopener">
        https://github.com/godotengine/godot/tree/master/modules/csg
       </a>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/754b928a67cbd8e6962f5dc2481dff1f1b100d29e5356711b1082dd5510b9c56.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      urho3d
     </div>
     <div class="post_content">
      <p>
       6 posts were split to a new topic:
       <a href="/t/split-toxic-realtime-mesh-fracturing/4337">
        [Split - toxic] Realtime mesh fracturing
       </a>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/754b928a67cbd8e6962f5dc2481dff1f1b100d29e5356711b1082dd5510b9c56.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      urho3d
     </div>
     <div class="post_content">
      <p>
       Toxic posts removed. Please keep things civil and on topic.
      </p>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>