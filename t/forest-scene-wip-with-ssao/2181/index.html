<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width" name="viewport"/>
  <title>
   Forest Scene WIP - with SSAO
  </title>
  <link href="../../../archived.css" rel="stylesheet"/>
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
  </script>
  <script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
  </script>
 </head>
 <body>
  <header class="header">
   <div class="title-span">
    <a href="../../../">
     <img alt="Urho3D" height="40" id="site-logo" src="../../../images/site-logo.png"/>
    </a>
   </div>
  </header>
  <div class="main">
   <div class="archive-span">
    Archive 19/01/2023.
   </div>
   <h1 class="topic-title">
    Forest Scene WIP - with SSAO
   </h1>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9b7d4c71b48c7ca7c4d220fd2d267cd54a9023967101d205695adf3a898ed147.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      krstefan42
     </div>
     <div class="post_content">
      <p>
       Here’s a peek at a forest scene I’ve been working on. Right now I only have one tree model (made in Blender), but I plan to add a a lot more stuff. It uses an SSAO shader I wrote, which uses temporal reprojection to blend with the previous frame’s AO result to reduce noise (sadly it only takes into account the camera’s velocity, so fast moving objects will still have noise). I also wrote a higher-quality PCF shadow implementation, and made some other tweaks to the lighting code. I’ll upload the SSAO code when finished (right now the temporal reprojection is using a weird hack involving a magic constant. Since I don’t know why the hack fixes my code, I don’t know if it will work for other scenes with different scale parameters, FOV, etc. If anyone wants to help me figure it out I can show you the code tomorrow).
      </p>
      <p>
       <img alt="" height="" src="missing_image.png?original=https%3A//s4.postimg.org/o4ny928lp/Forest1.jpg" width=""/>
      </p>
      <p>
       The tree model might look on the heavy side, but really fill rate is far more likely to be a bottleneck than triangle count on modern hardware, and I used some tricks to make them look more detailed than they really are (plus LOD models). The scene contains 500 trees, but I still get 60FPS thanks to the LODs.
      </p>
      <p>
       Here’s a shot of the raw AO term:
      </p>
      <p>
       <img alt="" height="" src="missing_image.png?original=https%3A//s4.postimg.org/afb3q2s5p/Forest6.jpg" width=""/>
      </p>
      <p>
       Here’s some more screenshots, click to open.
      </p>
      <p>
       <a data-bbcode="true" href="https://postimg.org/image/vmbuqo67j/" rel="nofollow noopener">
        <img alt="" height="" src="missing_image.png?original=https%3A//s3.postimg.org/vmbuqo67j/Forest2.jpg" width=""/>
       </a>
      </p>
      <p>
       <a data-bbcode="true" href="https://postimg.org/image/od5fhdxl5/" rel="nofollow noopener">
        <img alt="" height="" src="missing_image.png?original=https%3A//s4.postimg.org/od5fhdxl5/Forest3.jpg" width=""/>
       </a>
      </p>
      <p>
       <a data-bbcode="true" href="https://postimg.org/image/ub1gx8uj3/" rel="nofollow noopener">
        <img alt="" height="" src="missing_image.png?original=https%3A//s3.postimg.org/ub1gx8uj3/Forest5.jpg" width=""/>
       </a>
      </p>
      <p>
       <a data-bbcode="true" href="https://postimg.org/image/90bcvijgp/" rel="nofollow noopener">
        <img alt="" height="" src="missing_image.png?original=https%3A//s4.postimg.org/90bcvijgp/Forest4.jpg" width=""/>
       </a>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/3fae9a3c77d58dff7a184b992d1555d6f939c76e8f4e9f8a3640c249d001e184.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      yushli
     </div>
     <div class="post_content">
      <p>
       That looks amazing. look forward to your sample project so that I can try it out.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/7f16d2ff0d27ff8e240b37b3bf60e2c661b5eb8800a5a99829abc8fc983cac04.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      franck22000
     </div>
     <div class="post_content">
      <p>
       Looking forward for the SSAO shader release
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
       Nice work !
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/8f5367735420e58b91eda6d4f15703469e596b17abcba973991742a73761b827.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      zedraken
     </div>
     <div class="post_content">
      <p>
       It is really a very nice work, very impressive !
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/35cda981c3403e28c7f80229c59e72f5521005561acb2586edf2bd1909df9578.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      dragonCASTjosh
     </div>
     <div class="post_content">
      <p>
       awesome work and im happy to help iv been looking to do AO but hadent gotten round to it
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/1942bc04975c75156629598f61ba11bcc001f312ff469070f61448e051f874dd.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Lumak
     </div>
     <div class="post_content">
      <p>
       This looks great!
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/999065d0609f591a82c8a3f4f534d814fd1605f4d7ed98ff3bc0d9aed9d27d87.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      codingmonkey
     </div>
     <div class="post_content">
      <p>
       nice!
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/684585e23c00534a4d0cb1c1bc542909f34fad260b0ad446b3e3b5a99d7771d5.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      sabotage3d
     </div>
     <div class="post_content">
      <p>
       There is already SSAO by reattiva, but it is quite old now. I think it was AngelScript and I ported it to back C++. This is my repo:
       <a href="https://github.com/sabotage3d/UrhoSSAO" rel="nofollow noopener">
        github.com/sabotage3d/UrhoSSAO
       </a>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/9b7d4c71b48c7ca7c4d220fd2d267cd54a9023967101d205695adf3a898ed147.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      krstefan42
     </div>
     <div class="post_content">
      <p>
       Thanks guys!
      </p>
      <p>
       Hmm, I didn’t know someone had already done SSAO. I wonder why it hasn’t been merged into master? His implementation seems fairly similar to mine, but he uses a bilateral blur instead of temporal reprojection to reduce noise (reprojection is better and faster in theory, but my implementation is flawed because it doesn’t account for per-object velocity (which is not even possible without changes to the engine)). I figured out why I need the “magic constant” of around 500, and how to calculate the value properly from the FOV, thanks to a comment in his code. I’ll see if I can learn anything else from his implementation.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/c01b8b8b05b6aab492df6eeace88e2282147607ff86cdc28638e9227819a3fcc.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      Bananaft
     </div>
     <div class="post_content">
      <p>
       Looks lovely. Can you tell a bit more about your changes in lighting and shadows?
      </p>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>