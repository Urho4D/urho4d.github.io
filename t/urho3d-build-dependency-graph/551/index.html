<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width" name="viewport"/>
  <title>
   Urho3D Build Dependency Graph
  </title>
  <link href="../../../archived.css" rel="stylesheet"/>
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
  </script>
  <script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
  </script>
 </head>
 <body>
  <header class="header">
   <div class="title-span">
    <a href="../../../">
     <img alt="Urho3D" height="40" id="site-logo" src="../../../images/site-logo.png"/>
    </a>
   </div>
  </header>
  <div class="main">
   <div class="archive-span">
    Archive 19/01/2023.
   </div>
   <h1 class="topic-title">
    Urho3D Build Dependency Graph
   </h1>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/51c42213925d43f7d3684cbdfc7ef12224b1ffc9e2eb7f246a1560fb19ccd2a8.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      OvermindDL1
     </div>
     <div class="post_content">
      <p>
       I whipped up a build dependency graph for Urho3D, took about 48 minutes to compile it and the resultant SVG is
       <em>
        huge
       </em>
       so it takes a minute or two to load in Chrome for example, but if anyone wants it as it is interesting to look at:
       <a data-bbcode="true" href="http://overminddl1.com/Urho3D/Urho3DBuildDependencyGraph.svg" rel="nofollow noopener">
        http://overminddl1.com/Urho3D/Urho3DBuildDependencyGraph.svg
       </a>
      </p>
      <p>
       Conclusion:  Urho3D has a fairly flat dependency graph, it is beautiful.
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/ac13286af345bef5a8e8da90a88e9fc0e9d6f349d8aa367436e7ffdeeddaeb9e.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      weitjong
     </div>
     <div class="post_content">
      <p>
       I think I need a bigger screen!
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
      </p>
      <p>
       Could you share how you generate it?
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/51c42213925d43f7d3684cbdfc7ef12224b1ffc9e2eb7f246a1560fb19ccd2a8.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      OvermindDL1
     </div>
     <div class="post_content">
      <p>
       [quote=“weitjong”]I think I need a bigger screen!
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
      </p>
      <p>
       Could you share how you generate it?[/quote]
       <br/>
       It is Ninja.  Ninja is a replacement build system for makefiles, same task, it is just not for humans to write, it is designed to be generated by machines, like by CMake, and it is extremely fast compared to make with a lot of features from distribution to graph generation.  I have my local Urho3D cmake_gcc.sh file modified to default to “Ninja” instead of “Unix Makefiles” to help my build time and I use a few of its features.  Really wish that “Unix Makefiles” were not hardcoded, though I really wish the sh file was not necessary.  ^.^
      </p>
      <pre><code class="lang-auto">ninja -t graph | dot &lt;whatever args you want&gt;</code></pre>
      <p>
       As an example, ninja generates the graph in a couple of seconds, dot/graphviz is what takes forever depending on your settings, and I had mine set fairly high.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/ac13286af345bef5a8e8da90a88e9fc0e9d6f349d8aa367436e7ffdeeddaeb9e.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      weitjong
     </div>
     <div class="post_content">
      <p>
       I am curious about Ninja for quite some time now. Cool stuff.
      </p>
      <aside class="quote no-group" data-username="OvermindDL1">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/8307807bb8cefa9e0fc8e8de486fc93d4a2939d077f8080962166ea46f2a9e6c.png" width="20"/>
        OvermindDL1:
       </div>
       <blockquote>
        <p>
         Really wish that “Unix Makefiles” were not hardcoded, though I really wish the sh file was not necessary.
        </p>
       </blockquote>
      </aside>
      <p>
       I do not see it that way. Our CMake build scripts are not hardcoded to only work with “Unix Makefiles”, or otherwise the build scripts would not work with Xcode or VS generator; or that your simple search-and-replace to the cmake_gcc.sh shell script would actually work. The shell script is there just to help to save us to key in a few keystrokes, especially when cross-compiling. On native build, I think one could just type in this manually “cmake -E chdir Build -G your-generator Source” and it should work. However, I believe some of us are even too lazy to type even just that
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
       . And that’s where the batch file and shell script come in.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/51c42213925d43f7d3684cbdfc7ef12224b1ffc9e2eb7f246a1560fb19ccd2a8.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      OvermindDL1
     </div>
     <div class="post_content">
      <p>
       [quote=“weitjong”]I am curious about Ninja for quite some time now. Cool stuff.
      </p>
      <aside class="quote no-group" data-username="OvermindDL1">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/8307807bb8cefa9e0fc8e8de486fc93d4a2939d077f8080962166ea46f2a9e6c.png" width="20"/>
        OvermindDL1:
       </div>
       <blockquote>
        <p>
         Really wish that “Unix Makefiles” were not hardcoded, though I really wish the sh file was not necessary.
        </p>
       </blockquote>
      </aside>
      <p>
       I do not see it that way. Our CMake build scripts are not hardcoded to only work with “Unix Makefiles”, or otherwise the build scripts would not work with Xcode or VS generator; or that your simple search-and-replace to the cmake_gcc.sh shell script would actually work. The shell script is there just to help to save us to key in a few keystrokes, especially when cross-compiling. On native build, I think one could just type in this manually “cmake -E chdir Build -G your-generator Source” and it should work. However, I believe some of us are even too lazy to type even just that
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
       . And that’s where the batch file and shell script come in.[/quote]
       <br/>
       Heh, I use either KDevelop (which works well with Urho3D) or Jenkins/gitlab-ci to do it all so I rarely touch things, just the main thing about some vars not being exposed as Options through CMake (been a while since I double checked those though…).
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/ac13286af345bef5a8e8da90a88e9fc0e9d6f349d8aa367436e7ffdeeddaeb9e.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      weitjong
     </div>
     <div class="post_content">
      <p>
       We have done some minor refactoring on how we handle the build options not too long ago. Most of the build options (if not all) should be now accounted for. Of course we don’t necessarily see all our CMake variables should be exposed as build options.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/51c42213925d43f7d3684cbdfc7ef12224b1ffc9e2eb7f246a1560fb19ccd2a8.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      OvermindDL1
     </div>
     <div class="post_content">
      <aside class="quote">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/0cf59ce0315b40e419c5880c4cc7ce42bfee4362fec2d6c44d96ea426f303658.png" width="20"/>
        weitjong:
       </div>
       <blockquote>
        <p>
         We have done some minor refactoring on how we handle the build options not too long ago. Most of the build options (if not all) should be now accounted for. Of course we don’t necessarily see all our CMake variables should be exposed as build options.
        </p>
       </blockquote>
      </aside>
      <p>
       It seems they are all listed now, fantastic, however some of them do not appear at all unless certain others are chosen, like the URHO3D_LUAJIT_AMALG does not appear until URHO3D_LUAJIT is chosen first for example, then regenerated, which makes me have to generate it three times in the IDE, first to get the options, second to select the first set, and third to select the new ones that appear.  Any user-settable options should always be visible even if not used, it is usually good to have a section in the main file that defines all of the options so they will appear, and used where-ever they need to be used just as they already are.
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/ac13286af345bef5a8e8da90a88e9fc0e9d6f349d8aa367436e7ffdeeddaeb9e.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      weitjong
     </div>
     <div class="post_content">
      <p>
       Well, it depends on who you ask. I personally actually like it this way. Unless you are using LuaJIT then LuaJIT specific options are unavailable. Similarly for Lua. Unless you are targeting Windows platform then OpenGL option is not available, i.e. only on Windows platform one can choose to use D3D9 or OpenGL; in other platforms this option is useless if it were defined (which is exactly why it is not). In short a few build options are purposely designed to be dependent on other build option and CMake variable.
      </p>
     </div>
    </div>
   </div>
   <div class="post_container">
    <div class="avatar_container">
     <img class="avatar" src="../../../images/51c42213925d43f7d3684cbdfc7ef12224b1ffc9e2eb7f246a1560fb19ccd2a8.png"/>
    </div>
    <div class="post">
     <div class="user_name">
      OvermindDL1
     </div>
     <div class="post_content">
      <aside class="quote">
       <div class="title">
        <div class="quote-controls">
        </div>
        <img alt="" class="avatar" height="20" src="../../../images/0cf59ce0315b40e419c5880c4cc7ce42bfee4362fec2d6c44d96ea426f303658.png" width="20"/>
        weitjong:
       </div>
       <blockquote>
        <p>
         Well, it depends on who you ask. I personally actually like it this way. Unless you are using LuaJIT then LuaJIT specific options are unavailable. Similarly for Lua. Unless you are targeting Windows platform then OpenGL option is not available, i.e. only on Windows platform one can choose to use D3D9 or OpenGL; in other platforms this option is useless if it were defined (which is exactly why it is not). In short a few build options are purposely designed to be dependent on other build option and CMake variable.
        </p>
       </blockquote>
      </aside>
      <p>
       Understandable, it just breaks the GUI’s is all so it is not as clean, but understandable.
       <img alt=":slight_smile:" class="emoji" src="../../../images/8a8941f0486df9dda1e89ec988e1591cf959e1ea7809a249dc2decb694b30a6c.png" title=":slight_smile:"/>
      </p>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>